<!doctype html>














<!-- `site.alt_lang` can specify a language different from the UI -->
<html lang="zh" >
  <head>
  <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
  <meta name="theme-color" media="(prefers-color-scheme: light)" content="#f7f7f7">
  <meta name="theme-color" media="(prefers-color-scheme: dark)" content="#1b1b1e">
  <meta name="mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <meta
    name="viewport"
    content="width=device-width, user-scalable=no initial-scale=1, shrink-to-fit=no, viewport-fit=cover"
  ><!-- Setup Open Graph image -->

  

  <!-- Begin Jekyll SEO tag v2.8.0 -->
<meta name="generator" content="Jekyll v4.4.1" />
<meta property="og:title" content="BIT ECE实习之STM32开发" />
<meta name="author" content="lamaper" />
<meta property="og:locale" content="zh" />
<meta name="description" content="在BIT网安ECE实习中的一些笔记" />
<meta property="og:description" content="在BIT网安ECE实习中的一些笔记" />
<link rel="canonical" href="/posts/bit-ece-stm32/" />
<meta property="og:url" content="/posts/bit-ece-stm32/" />
<meta property="og:site_name" content="lamaper" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2025-09-08T16:11:23+08:00" />
<meta name="twitter:card" content="summary" />
<meta property="twitter:title" content="BIT ECE实习之STM32开发" />
<script type="application/ld+json">
{"@context":"https://schema.org","@type":"BlogPosting","author":{"@type":"Person","name":"lamaper","url":"https://github.com/lamaper/"},"dateModified":"2025-09-08T16:11:23+08:00","datePublished":"2025-09-08T16:11:23+08:00","description":"在BIT网安ECE实习中的一些笔记","headline":"BIT ECE实习之STM32开发","mainEntityOfPage":{"@type":"WebPage","@id":"/posts/bit-ece-stm32/"},"url":"/posts/bit-ece-stm32/"}</script>
<!-- End Jekyll SEO tag -->


  <title>BIT ECE实习之STM32开发 | lamaper
  </title>

  <!--
  The Favicons for Web, Android, Microsoft, and iOS (iPhone and iPad) Apps
  Generated by: https://realfavicongenerator.net/
-->



<link rel="icon" type="image/png" href="/assets/img/favicons/favicon-96x96.png" sizes="96x96">
<link rel="icon" type="image/svg+xml" href="/assets/img/favicons/favicon.svg">
<link rel="shortcut icon" href="/assets/img/favicons/favicon.ico">
<link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-touch-icon.png">

  <link rel="manifest" href="/assets/img/favicons/site.webmanifest">



  <!-- Resource Hints -->
  
    
      
        <link rel="preconnect" href="https://fonts.googleapis.com" >
      
        <link rel="dns-prefetch" href="https://fonts.googleapis.com" >
      
    
      
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
      
        <link rel="dns-prefetch" href="https://fonts.gstatic.com" >
      
    
      
        <link rel="preconnect" href="https://cdn.jsdelivr.net" >
      
        <link rel="dns-prefetch" href="https://cdn.jsdelivr.net" >
      
    
  

  <!-- Bootstrap -->
  
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.8/dist/css/bootstrap.min.css">
  

  <!-- Theme style -->
  <link rel="stylesheet" href="/assets/css/jekyll-theme-chirpy.css">

  <!-- Web Font -->
  <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Lato:wght@300;400&family=Source+Sans+Pro:wght@400;600;700;900&display=swap">

  <!-- Font Awesome Icons -->
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@7.1.0/css/all.min.css">

  <!-- 3rd-party Dependencies -->

  
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/tocbot@4.36.4/dist/tocbot.min.css">
  

  
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/loading-attribute-polyfill@2.1.1/dist/loading-attribute-polyfill.min.css">
  

  
    <!-- Image Popup -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/glightbox@3.3.0/dist/css/glightbox.min.css">
  

  <!-- Scripts -->

  <script src="/assets/js/dist/theme.min.js"></script>

  <!-- JS selector for site. -->

<!-- commons -->



<!-- layout specified -->


  

  
    <!-- image lazy-loading & popup & clipboard -->
    
  















  
    

    

  

  
    

    

  

  
    

    

  

  
    

    

  

  
    

    

  

  
    

    

  

  
    

    

  

  
    

    

  

  
    

    

  

  
    

    

  



  <script defer src="https://cdn.jsdelivr.net/combine/npm/simple-jekyll-search@1.10.0/dest/simple-jekyll-search.min.js,npm/loading-attribute-polyfill@2.1.1/dist/loading-attribute-polyfill.umd.min.js,npm/glightbox@3.3.0/dist/js/glightbox.min.js,npm/clipboard@2.0.11/dist/clipboard.min.js,npm/dayjs@1.11.18/dayjs.min.js,npm/dayjs@1.11.18/locale/en.js,npm/dayjs@1.11.18/plugin/relativeTime.js,npm/dayjs@1.11.18/plugin/localizedFormat.js,npm/tocbot@4.36.4/dist/tocbot.min.js,npm/mermaid@11.12.0/dist/mermaid.min.js"></script>







<script defer src="/assets/js/dist/post.min.js"></script>


  <!-- MathJax -->
  <script src="/assets/js/data/mathjax.js"></script>
  <script async src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3.2.2/es5/tex-chtml.js"></script>


<!-- Pageviews -->

  

  



  

  <!-- A placeholder to allow defining custom metadata -->

</head>


  <body>
    <!-- The Side Bar -->

<aside aria-label="Sidebar" id="sidebar" class="d-flex flex-column align-items-end">
  <header class="profile-wrapper">
    <a href="/" id="avatar" class="rounded-circle"><img src="https://avatars.githubusercontent.com/u/108182318?v=4" width="112" height="112" alt="avatar" onerror="this.style.display='none'"></a>

    <a class="site-title d-block" href="/">lamaper</a>
    <p class="site-subtitle fst-italic mb-0">Web / CTF / Coding</p>
  </header>
  <!-- .profile-wrapper -->

  <nav class="flex-column flex-grow-1 w-100 ps-0">
    <ul class="nav">
      <!-- home -->
      <li class="nav-item">
        <a href="/" class="nav-link">
          <i class="fa-fw fas fa-home"></i>
          <span>HOME</span>
        </a>
      </li>
      <!-- the real tabs -->
      
        <li class="nav-item">
          <a href="/categories/" class="nav-link">
            <i class="fa-fw fas fa-stream"></i>
            

            <span>CATEGORIES</span>
          </a>
        </li>
        <!-- .nav-item -->
      
        <li class="nav-item">
          <a href="/tags/" class="nav-link">
            <i class="fa-fw fas fa-tags"></i>
            

            <span>TAGS</span>
          </a>
        </li>
        <!-- .nav-item -->
      
        <li class="nav-item">
          <a href="/archives/" class="nav-link">
            <i class="fa-fw fas fa-archive"></i>
            

            <span>ARCHIVES</span>
          </a>
        </li>
        <!-- .nav-item -->
      
        <li class="nav-item">
          <a href="/about/" class="nav-link">
            <i class="fa-fw fas fa-info-circle"></i>
            

            <span>ABOUT</span>
          </a>
        </li>
        <!-- .nav-item -->
      
    </ul>
  </nav>

  <div class="sidebar-bottom d-flex flex-wrap  align-items-center w-100">
    
      <button type="button" class="btn btn-link nav-link" aria-label="Switch Mode" id="mode-toggle">
        <i class="fas fa-adjust"></i>
      </button>

      
        <span class="icon-border"></span>
      
    

    

      
        <a
          href="https://github.com/lamaper"
          aria-label="github"
          

          
            target="_blank"
            
          

          

          
            rel="noopener noreferrer"
          
        >
          <i class="fab fa-github"></i>
        </a>
      
    

      
        <a
          href="javascript:location.href = 'mailto:' + ['lamaper','qq.com'].join('@')"
          aria-label="email"
          

          

          

          
        >
          <i class="fas fa-envelope"></i>
        </a>
      
    
          
        

      
        <a
          href="/feed.xml"
          aria-label="rss"
          

          

          

          
        >
          <i class="fas fa-rss"></i>
        </a>
      
    
  </div>
  <!-- .sidebar-bottom -->
</aside>
<!-- #sidebar -->


    <div id="main-wrapper" class="d-flex justify-content-center">
      <div class="container d-flex flex-column px-xxl-5">
        <!-- The Top Bar -->

<header id="topbar-wrapper" class="flex-shrink-0" aria-label="Top Bar">
  <div
    id="topbar"
    class="d-flex align-items-center justify-content-between px-lg-3 h-100"
  >
    <nav id="breadcrumb" aria-label="Breadcrumb">
      

      
        
          
            <span>
              <a href="/">Home</a>
            </span>

          
        
          
        
          
            
              <span>BIT ECE实习之STM32开发</span>
            

          
        
      
    </nav>
    <!-- endof #breadcrumb -->

    <button type="button" id="sidebar-trigger" class="btn btn-link" aria-label="Sidebar">
      <i class="fas fa-bars fa-fw"></i>
    </button>

    <div id="topbar-title">
      Post
    </div>

    <button type="button" id="search-trigger" class="btn btn-link" aria-label="Search">
      <i class="fas fa-search fa-fw"></i>
    </button>

    <search id="search" class="align-items-center ms-3 ms-lg-0">
      <i class="fas fa-search fa-fw"></i>
      <input
        class="form-control"
        id="search-input"
        type="search"
        aria-label="search"
        autocomplete="off"
        placeholder="Search..."
      >
    </search>
    <button type="button" class="btn btn-link text-decoration-none" id="search-cancel">Cancel</button>
  </div>
</header>


        <div class="row flex-grow-1">
          <main aria-label="Main Content" class="col-12 col-lg-11 col-xl-9 px-md-4">
            
              <!-- Refactor the HTML structure -->



<!--
  In order to allow a wide table to scroll horizontally,
  we suround the markdown table with `<div class="table-wrapper">` and `</div>`
-->



<!--
  Fixed kramdown code highlight rendering:
  https://github.com/penibelst/jekyll-compress-html/issues/101
  https://github.com/penibelst/jekyll-compress-html/issues/71#issuecomment-188144901
-->



<!-- Change the icon of checkbox -->



<!-- Handle images -->




  
  

  
    
      
      
    

    
    

    

    
    

    
    
    

    
      

      
      
      

      
    
      

      
      
      

      
    

    <!-- take out classes -->
    

    

    
    

    

    
      
    

    <!-- lazy-load images -->
    

    
      <!-- make sure the `<img>` is wrapped by `<a>` -->
      

      
        <!-- create the image wrapper -->
        

        
        
      
    

    <!-- combine -->
    
  
    

    
    

    

    
    

    
    
    

    
      

      
      
      

      
    
      

      
      
      

      
    

    <!-- take out classes -->
    

    

    
    

    

    
      
    

    <!-- lazy-load images -->
    

    
      <!-- make sure the `<img>` is wrapped by `<a>` -->
      

      
        <!-- create the image wrapper -->
        

        
        
      
    

    <!-- combine -->
    
  
    

    
    

    

    
    

    
    
    

    
      

      
      
      

      
    
      

      
      
      

      
    

    <!-- take out classes -->
    

    

    
    

    

    
      
    

    <!-- lazy-load images -->
    

    
      <!-- make sure the `<img>` is wrapped by `<a>` -->
      

      
        <!-- create the image wrapper -->
        

        
        
      
    

    <!-- combine -->
    
  
    

    
    

    

    
    

    
    
    

    
      

      
      
      

      
    
      

      
      
      

      
    

    <!-- take out classes -->
    

    

    
    

    

    
      
    

    <!-- lazy-load images -->
    

    
      <!-- make sure the `<img>` is wrapped by `<a>` -->
      

      
        <!-- create the image wrapper -->
        

        
        
      
    

    <!-- combine -->
    
  
    

    
    

    

    
    

    
    
    

    
      

      
      
      

      
    
      

      
      
      

      
    

    <!-- take out classes -->
    

    

    
    

    

    
      
    

    <!-- lazy-load images -->
    

    
      <!-- make sure the `<img>` is wrapped by `<a>` -->
      

      
        <!-- create the image wrapper -->
        

        
        
      
    

    <!-- combine -->
    
  
    

    
    

    

    
    

    
    
    

    
      

      
      
      

      
    
      

      
      
      

      
    

    <!-- take out classes -->
    

    

    
    

    

    
      
    

    <!-- lazy-load images -->
    

    
      <!-- make sure the `<img>` is wrapped by `<a>` -->
      

      
        <!-- create the image wrapper -->
        

        
        
      
    

    <!-- combine -->
    
  
    

    
    

    

    
    

    
    
    

    
      

      
      
      

      
    
      

      
      
      

      
    

    <!-- take out classes -->
    

    

    
    

    

    
      
    

    <!-- lazy-load images -->
    

    
      <!-- make sure the `<img>` is wrapped by `<a>` -->
      

      
        <!-- create the image wrapper -->
        

        
        
      
    

    <!-- combine -->
    
  
    

    
    

    

    
    

    
    
    

    
      

      
      
      

      
    
      

      
      
      

      
    

    <!-- take out classes -->
    

    

    
    

    

    
      
    

    <!-- lazy-load images -->
    

    
      <!-- make sure the `<img>` is wrapped by `<a>` -->
      

      
        <!-- create the image wrapper -->
        

        
        
      
    

    <!-- combine -->
    
  
    

    
    

    

    
    

    
    
    

    
      

      
      
      

      
    
      

      
      
      

      
    

    <!-- take out classes -->
    

    

    
    

    

    
      
    

    <!-- lazy-load images -->
    

    
      <!-- make sure the `<img>` is wrapped by `<a>` -->
      

      
        <!-- create the image wrapper -->
        

        
        
      
    

    <!-- combine -->
    
  
    

    
    

    

    
    

    
    
    

    
      

      
      
      

      
    
      

      
      
      

      
    

    <!-- take out classes -->
    

    

    
    

    

    
      
    

    <!-- lazy-load images -->
    

    
      <!-- make sure the `<img>` is wrapped by `<a>` -->
      

      
        <!-- create the image wrapper -->
        

        
        
      
    

    <!-- combine -->
    
  
    

    
    

    

    
    

    
    
    

    
      

      
      
      

      
    
      

      
      
      

      
    

    <!-- take out classes -->
    

    

    
    

    

    
      
    

    <!-- lazy-load images -->
    

    
      <!-- make sure the `<img>` is wrapped by `<a>` -->
      

      
        <!-- create the image wrapper -->
        

        
        
      
    

    <!-- combine -->
    
  
    

    
    

    

    
    

    
    
    

    
      

      
      
      

      
    
      

      
      
      

      
    

    <!-- take out classes -->
    

    

    
    

    

    
      
    

    <!-- lazy-load images -->
    

    
      <!-- make sure the `<img>` is wrapped by `<a>` -->
      

      
        <!-- create the image wrapper -->
        

        
        
      
    

    <!-- combine -->
    
  
    

    
    

    

    
    

    
    
    

    
      

      
      
      

      
    
      

      
      
      

      
    

    <!-- take out classes -->
    

    

    
    

    

    
      
    

    <!-- lazy-load images -->
    

    
      <!-- make sure the `<img>` is wrapped by `<a>` -->
      

      
        <!-- create the image wrapper -->
        

        
        
      
    

    <!-- combine -->
    
  
    

    
    

    

    
    

    
    
    

    
      

      
      
      

      
    
      

      
      
      

      
    

    <!-- take out classes -->
    

    

    
    

    

    
      
    

    <!-- lazy-load images -->
    

    
      <!-- make sure the `<img>` is wrapped by `<a>` -->
      

      
        <!-- create the image wrapper -->
        

        
        
      
    

    <!-- combine -->
    
  
    

    
    

    

    
    

    
    
    

    
      

      
      
      

      
    
      

      
      
      

      
    

    <!-- take out classes -->
    

    

    
    

    

    
      
    

    <!-- lazy-load images -->
    

    
      <!-- make sure the `<img>` is wrapped by `<a>` -->
      

      
        <!-- create the image wrapper -->
        

        
        
      
    

    <!-- combine -->
    
  
    

    
    

    

    
    

    
    
    

    
      

      
      
      

      
    
      

      
      
      

      
    

    <!-- take out classes -->
    

    

    
    

    

    
      
    

    <!-- lazy-load images -->
    

    
      <!-- make sure the `<img>` is wrapped by `<a>` -->
      

      
        <!-- create the image wrapper -->
        

        
        
      
    

    <!-- combine -->
    
  
    

    
    

    

    
    

    
    
    

    
      

      
      
      

      
    
      

      
      
      

      
    

    <!-- take out classes -->
    

    

    
    

    

    
      
    

    <!-- lazy-load images -->
    

    
      <!-- make sure the `<img>` is wrapped by `<a>` -->
      

      
        <!-- create the image wrapper -->
        

        
        
      
    

    <!-- combine -->
    
  
    

    
    

    

    
    

    
    
    

    
      

      
      
      

      
    
      

      
      
      

      
    

    <!-- take out classes -->
    

    

    
    

    

    
      
    

    <!-- lazy-load images -->
    

    
      <!-- make sure the `<img>` is wrapped by `<a>` -->
      

      
        <!-- create the image wrapper -->
        

        
        
      
    

    <!-- combine -->
    
  
    

    
    

    

    
    

    
    
    

    
      

      
      
      

      
    
      

      
      
      

      
    

    <!-- take out classes -->
    

    

    
    

    

    
      
    

    <!-- lazy-load images -->
    

    
      <!-- make sure the `<img>` is wrapped by `<a>` -->
      

      
        <!-- create the image wrapper -->
        

        
        
      
    

    <!-- combine -->
    
  
    

    
    

    

    
    

    
    
    

    
      

      
      
      

      
    
      

      
      
      

      
    

    <!-- take out classes -->
    

    

    
    

    

    
      
    

    <!-- lazy-load images -->
    

    
      <!-- make sure the `<img>` is wrapped by `<a>` -->
      

      
        <!-- create the image wrapper -->
        

        
        
      
    

    <!-- combine -->
    
  
    

    
    

    

    
    

    
    
    

    
      

      
      
      

      
    
      

      
      
      

      
    

    <!-- take out classes -->
    

    

    
    

    

    
      
    

    <!-- lazy-load images -->
    

    
      <!-- make sure the `<img>` is wrapped by `<a>` -->
      

      
        <!-- create the image wrapper -->
        

        
        
      
    

    <!-- combine -->
    
  
    

    
    

    

    
    

    
    
    

    
      

      
      
      

      
    
      

      
      
      

      
    

    <!-- take out classes -->
    

    

    
    

    

    
      
    

    <!-- lazy-load images -->
    

    
      <!-- make sure the `<img>` is wrapped by `<a>` -->
      

      
        <!-- create the image wrapper -->
        

        
        
      
    

    <!-- combine -->
    
  
    

    
    

    

    
    

    
    
    

    
      

      
      
      

      
    
      

      
      
      

      
    

    <!-- take out classes -->
    

    

    
    

    

    
      
    

    <!-- lazy-load images -->
    

    
      <!-- make sure the `<img>` is wrapped by `<a>` -->
      

      
        <!-- create the image wrapper -->
        

        
        
      
    

    <!-- combine -->
    
  

  


<!-- Add header for code snippets -->



<!-- Create heading anchors -->





  
  

  
    
    

    
      
        
        
      

      
      

      
      
      

      
    
      

      
      

      
      
      

      
    
      

      
      

      
      
      

      
    

    
  

  
  

  
    
    

    
      
        
        
      

      
      

      
      
      

      
    
      

      
      

      
      
      

      
    
      

      
      

      
      
      

      
    
      

      
      

      
      
      

      
    
      

      
      

      
      
      

      
    
      

      
      

      
      
      

      
    
      

      
      

      
      
      

      
    
      

      
      

      
      
      

      
    
      

      
      

      
      
      

      
    
      

      
      

      
      
      

      
    

    
  

  
  

  

  
  

  




<!-- return -->










<article class="px-1" data-toc="true">
  <header>
    <h1 data-toc-skip>BIT ECE实习之STM32开发</h1>
    
      <p class="post-desc fw-light mb-4">在BIT网安ECE实习中的一些笔记</p>
    

    <div class="post-meta text-muted">
      <!-- published date -->
      <span>
        Posted
        <!--
  Date format snippet
  See: ${JS_ROOT}/utils/locale-dateime.js
-->




<time
  
  data-ts="1757319083"
  data-df="ll"
  
    data-bs-toggle="tooltip" data-bs-placement="bottom"
  
>
  Sep  8, 2025
</time>

      </span>

      <!-- lastmod date -->
      

      

      <div class="d-flex justify-content-between">
        <!-- author(s) -->
        <span>
          

          By

          <em>
            
              
                <a href="https://github.com/lamaper/">lamaper</a>
                
              
            
          </em>
        </span>

        <div>
          <!-- pageviews -->
          

          <!-- read time -->
          <!-- Calculate the post's reading time, and display the word count in tooltip -->



<!-- words per minute -->










<!-- return element -->
<span
  class="readtime"
  data-bs-toggle="tooltip"
  data-bs-placement="bottom"
  title="7001 words"
>
  <em>38 min</em> read</span>

        </div>
      </div>
    </div>
  </header>

  
    <div id="toc-bar" class="d-flex align-items-center justify-content-between invisible">
      <span class="label text-truncate">BIT ECE实习之STM32开发</span>
      <button type="button" class="toc-trigger btn me-1">
        <i class="fa-solid fa-list-ul fa-fw"></i>
      </button>
    </div>

    <button id="toc-solo-trigger" type="button" class="toc-trigger btn btn-outline-secondary btn-sm">
      <span class="label ps-2 pe-1">Contents</span>
      <i class="fa-solid fa-angle-right fa-fw"></i>
    </button>

    <dialog id="toc-popup" class="p-0">
      <div class="header d-flex flex-row align-items-center justify-content-between">
        <div class="label text-truncate py-2 ms-4">BIT ECE实习之STM32开发</div>
        <button id="toc-popup-close" type="button" class="btn mx-1 my-1 opacity-75">
          <i class="fas fa-close"></i>
        </button>
      </div>
      <div id="toc-popup-content" class="px-4 py-3 pb-4"></div>
    </dialog>
  

  <div class="content">
    <h2 id="一配置环境"><span class="me-2">一、配置环境</span><a href="#一配置环境" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2>

<h3 id="1ide安装"><span class="me-2">1、IDE安装</span><a href="#1ide安装" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3>

<p>我采用JetBrian开发的Clion进行开发，该软件对非商业用途免费，进入官网<a href="https://www.jetbrains.com/clion/">CLion
Free for non-commercial use</a>即可直接下载安装。</p>

<h3 id="2cubemx与cubeclt"><span class="me-2">2、CubeMX与CubeCLT</span><a href="#2cubemx与cubeclt" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3>
<p>我采用<a href="keysking.com">keysking</a>开发的<a href="https://fubemx.keysking.com/">FubeMX</a>协助进行环境安装。首先安装FubeMX，目录随意。安装完成后打开：</p>

<p><a href="https://img2024.cnblogs.com/blog/2914490/202509/2914490-20250908145158804-268540574.png" class="popup img-link shimmer"><img src="https://img2024.cnblogs.com/blog/2914490/202509/2914490-20250908145158804-268540574.png" alt="" loading="lazy"></a></p>

<p>从此处先安装STM32CubeMX，也可以在<a href="https://www.st.com/en/development-tools/stm32cubemx.html">官网</a>进行下载。下载好安装包后按默认路径安装，一路确定即可。</p>

<p>之后继续从此处安装STM32CubeCLT，与上述操作一样地，下载好安装包后按默认路径安装，一路确定即可。</p>

<p>此处安装可以参考<a href="https://www.bilibili.com/video/BV1pnjizYEAk">爽！手把手教你用CLion开发STM32【大人，时代变啦！！！】</a>，只需参考CubeMX与CubeCLT安装部分即可。</p>

<h3 id="3openocd安装"><span class="me-2">3、OpenOCD安装</span><a href="#3openocd安装" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3>
<p>OpenOCD则在官网<a href="https://gnutoolchains.com/arm-eabi/openocd/">Download OpenOCD for Windows</a>下载并安装，同样下载好安装包后按默认路径安装，一路确定即可。</p>

<h3 id="4clion配置"><span class="me-2">4、Clion配置</span><a href="#4clion配置" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3>

<p>打开Clion：
<a href="https://img2024.cnblogs.com/blog/2914490/202509/2914490-20250908145736866-965549483.png" class="popup img-link shimmer"><img src="https://img2024.cnblogs.com/blog/2914490/202509/2914490-20250908145736866-965549483.png" alt="" loading="lazy"></a></p>

<p>点击设置（Settings）：
<a href="https://img2024.cnblogs.com/blog/2914490/202509/2914490-20250908145754297-1204800734.png" class="popup img-link shimmer"><img src="https://img2024.cnblogs.com/blog/2914490/202509/2914490-20250908145754297-1204800734.png" alt="" loading="lazy"></a></p>

<p>之后按照安装路径参考图片进行配置：
<a href="https://img2024.cnblogs.com/blog/2914490/202509/2914490-20250908145949129-126559454.png" class="popup img-link shimmer"><img src="https://img2024.cnblogs.com/blog/2914490/202509/2914490-20250908145949129-126559454.png" alt="" loading="lazy"></a></p>

<p>注意选择编译器时，使用<code class="language-plaintext highlighter-rouge">arm-none-eabi-gcc.exe</code>和，<code class="language-plaintext highlighter-rouge">arm-none-eabi-g++.exe</code>。</p>

<p>之后修改CMake配置：
<a href="https://img2024.cnblogs.com/blog/2914490/202509/2914490-20250908150114272-1089790573.png" class="popup img-link shimmer"><img src="https://img2024.cnblogs.com/blog/2914490/202509/2914490-20250908150114272-1089790573.png" alt="" loading="lazy"></a></p>

<p>然后记住安装上述三个工具的路径，配置嵌入式开发环境：
<a href="https://img2024.cnblogs.com/blog/2914490/202509/2914490-20250908150209013-1789263183.png" class="popup img-link shimmer"><img src="https://img2024.cnblogs.com/blog/2914490/202509/2914490-20250908150209013-1789263183.png" alt="" loading="lazy"></a></p>

<p>最后在高级设置中启用调试器：
<a href="https://img2024.cnblogs.com/blog/2914490/202509/2914490-20250908150303882-1370651789.png" class="popup img-link shimmer"><img src="https://img2024.cnblogs.com/blog/2914490/202509/2914490-20250908150303882-1370651789.png" alt="" loading="lazy"></a></p>

<p>此处参考文献：</p>

<p><a href="https://www.bilibili.com/video/BV1pnjizYEAk/">爽！手把手教你用CLion开发STM32【大人，时代变啦！！！】 - bilibili</a></p>

<p><a href="https://www.cnblogs.com/bfmhno3/articles/18857357">【教程】配置 CLion 优雅开发 STM32 - 略无慕艳意 - 博客园</a></p>

<p>但要注意，上述配置过程中会遇到一些问题，需要参考本文后续叠加起来综合使用。</p>

<h2 id="二新建项目"><span class="me-2">二、新建项目：</span><a href="#二新建项目" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2>

<p>首先在Clion中点击新建嵌入式的项目：
<a href="https://img2024.cnblogs.com/blog/2914490/202509/2914490-20250908150505549-190964277.png" class="popup img-link shimmer"><img src="https://img2024.cnblogs.com/blog/2914490/202509/2914490-20250908150505549-190964277.png" alt="" loading="lazy"></a></p>

<p>注意不要直接新建，先点击<code class="language-plaintext highlighter-rouge">启动STM32CubeMX</code>，然后点击Start My project from MCU：
<a href="https://img2024.cnblogs.com/blog/2914490/202509/2914490-20250908150656217-1854978930.png" class="popup img-link shimmer"><img src="https://img2024.cnblogs.com/blog/2914490/202509/2914490-20250908150656217-1854978930.png" alt="" loading="lazy"></a></p>

<p>由于学校下发的材料为基于STM32F103VET6的<a href="https://doc.embedfire.com/products/link/zh/latest/mcu/stm32/stm32f103_zhinanzhe.html">野火指南者开发板</a>，输入芯片规格，选中芯片后点击Start Project：
<a href="https://img2024.cnblogs.com/blog/2914490/202509/2914490-20250908150847943-82305246.png" class="popup img-link shimmer"><img src="https://img2024.cnblogs.com/blog/2914490/202509/2914490-20250908150847943-82305246.png" alt="" loading="lazy"></a></p>

<p>按照如图方式选择调试模式，注意一定要选择Serial Wire：
<a href="https://img2024.cnblogs.com/blog/2914490/202509/2914490-20250908151008163-1576741069.png" class="popup img-link shimmer"><img src="https://img2024.cnblogs.com/blog/2914490/202509/2914490-20250908151008163-1576741069.png" alt="" loading="lazy"></a></p>

<p>选中后可以发现左侧GPIO标识变绿。最后设置项目名和工具链，注意工具链一定选择CMake：
<a href="https://img2024.cnblogs.com/blog/2914490/202509/2914490-20250908151203904-1496530551.png" class="popup img-link shimmer"><img src="https://img2024.cnblogs.com/blog/2914490/202509/2914490-20250908151203904-1496530551.png" alt="" loading="lazy"></a></p>

<p>最后点击右上角<code class="language-plaintext highlighter-rouge">GENERATE CORE</code>即可：<a href="https://img2024.cnblogs.com/blog/2914490/202509/2914490-20250908151303040-655512809.png" class="popup img-link shimmer"><img src="https://img2024.cnblogs.com/blog/2914490/202509/2914490-20250908151303040-655512809.png" alt="" loading="lazy"></a></p>

<p>记住路径后关闭窗口，回到Clion，将路径输入，可以发现此时可以创建项目了：
<a href="https://img2024.cnblogs.com/blog/2914490/202509/2914490-20250908151358179-1569177076.png" class="popup img-link shimmer"><img src="https://img2024.cnblogs.com/blog/2914490/202509/2914490-20250908151358179-1569177076.png" alt="" loading="lazy"></a></p>

<p>配置好Debug和Release两个CMake工具：
<a href="https://img2024.cnblogs.com/blog/2914490/202509/2914490-20250908151425043-1593323770.png" class="popup img-link shimmer"><img src="https://img2024.cnblogs.com/blog/2914490/202509/2914490-20250908151425043-1593323770.png" alt="" loading="lazy"></a></p>

<p>在此处点编辑配置：
<a href="https://img2024.cnblogs.com/blog/2914490/202509/2914490-20250908151546087-1152064907.png" class="popup img-link shimmer"><img src="https://img2024.cnblogs.com/blog/2914490/202509/2914490-20250908151546087-1152064907.png" alt="" loading="lazy"></a></p>

<p>进行OpenOCD配置：
<a href="https://img2024.cnblogs.com/blog/2914490/202509/2914490-20250908151732896-2032115607.png" class="popup img-link shimmer"><img src="https://img2024.cnblogs.com/blog/2914490/202509/2914490-20250908151732896-2032115607.png" alt="" loading="lazy"></a></p>

<p>注意此处要自己在任意位置新建一个<code class="language-plaintext highlighter-rouge">.cfg</code>文件，里面输入：</p>
<div class="language-plaintext highlighter-rouge"><div class="code-header">
        <span data-label-text="Plaintext"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
</pre></td><td class="rouge-code"><pre># 野火FireDAP仿真器配置（基于CMSIS-DAP）
source [find interface/cmsis-dap.cfg]

# 选择SWD接口
transport select swd

# 通信速率（1000kHz，兼容大多数情况）
adapter speed 1000

# 目标芯片配置
source [find target/stm32f1x.cfg]

# STM32F103VET6 Flash配置（512KB）
set FLASH_SIZE 0x80000

# 复位配置（关键：启用系统复位）
reset_config srst_only srst_nogate

# 核心逻辑：利用before_init回调，在init执行前强制配置端口
# 解决CLion命令顺序导致的"tcl port must be before init"错误
proc before_init {} {
    # 禁用tcl和gdb端口（使用正确的语法：tcl port 而非 tcl_port）
    tcl port disabled
    gdb port disabled
}
</pre></td></tr></tbody></table></code></div></div>

<p>最后点击确定即可。</p>

<p>代码在Core目录下，其中Src存放.c或.cpp文件，Inc存放.h文件：
<a href="https://img2024.cnblogs.com/blog/2914490/202509/2914490-20250908151924160-99783125.png" class="popup img-link shimmer"><img src="https://img2024.cnblogs.com/blog/2914490/202509/2914490-20250908151924160-99783125.png" alt="" loading="lazy"></a></p>

<p>此时如果连接开发板，点击绿色三角进行运行，若控制台显示如下良好，则表示配置完成。</p>
<div class="language-plaintext highlighter-rouge"><div class="code-header">
        <span data-label-text="Plaintext"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
</pre></td><td class="rouge-code"><pre>[0mOpen On-Chip Debugger 0.12.0 (2024-09-16)
. [https://github.com/sysprogs/openocd]
Licensed under GNU GPL v2
libusb1 d52e355daa09f17ce64819122cb067b8a2ee0d4b
For bug reports, read
        http://openocd.org/doc/doxygen/bugs.html
before_init
DEPRECATED! use 'tcl port' not 'tcl_port'
DEPRECATED! use 'gdb port', not 'gdb_port'
DEPRECATED! use 'tcl port' not 'tcl_port'
[0mInfo : CMSIS-DAP: SWD supported
Info : CMSIS-DAP: Atomic commands supported
Info : CMSIS-DAP: Test domain timer supported
Info : CMSIS-DAP: FW Version = 2.0.0
Info : CMSIS-DAP: Interface Initialised (SWD)
Info : SWCLK/TCK = 1 SWDIO/TMS = 1 TDI = 0 TDO = 1 nTRST = 0 nRESET = 1
Info : CMSIS-DAP: Interface ready
Info : clock speed 1000 kHz
Info : SWD DPIDR 0x1ba01477
Info : [stm32f1x.cpu] Cortex-M3 r1p1 processor detected
Info : [stm32f1x.cpu] target has 6 breakpoints, 4 watchpoints
Info : [stm32f1x.cpu] Examination succeed
Info : [stm32f1x.cpu] gdb port disabled
[stm32f1x.cpu] halted due to breakpoint, current mode: Thread
xPSR: 0x01000000 pc: 0x0800219c msp: 0x20010000
** Programming Started **
Info : device id = 0x10036414
Info : flash size = 512 KiB
Warn : Adding extra erase range, 0x080031ac .. 0x080037ff
** Programming Finished **
shutdown command invoked

</pre></td></tr></tbody></table></code></div></div>

<h2 id="三开发"><span class="me-2">三、开发</span><a href="#三开发" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2>
<p>本节中左右代码已上传至Github，仓库地址https://github.com/lamaper/BIT_ECE_STM32。</p>

<p>本节中所有作业来自上课课件，课件已经上传至<a href="https://onedrive.bit101.cn/zh-CN/course/ECE%E5%AE%9E%E4%B9%A0I-100120050/">BIT101仓库</a>，本课程编号：100120050。</p>

<p>本节中采用的硬件是学校派发的野火指南者开发板，本文采用<strong>HAL库</strong>开发而不是标准库。硬件官方参考文档：<a href="https://doc.embedfire.com/mcu/stm32/f103/hal_general/zh/latest/index.html">[野火]STM32 HAL库开发实战指南-基于F103系列开发板—文档</a>，其中给出了开发板外设地址：</p>
<div class="language-c highlighter-rouge"><div class="code-header">
        <span data-label-text="C"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
</pre></td><td class="rouge-code"><pre> <span class="cm">/*片上外设基地址  */</span>
 <span class="cp">#define PERIPH_BASE         ((unsigned int)0x40000000)
</span>
 <span class="cm">/*总线基地址，GPIO都挂载到APB2上 */</span>
 <span class="cp">#define APB2PERIPH_BASE     (PERIPH_BASE + 0x10000)
</span>
 <span class="cm">/*GPIOB外设基地址*/</span>
 <span class="cp">#define GPIOA_BASE          (APB2PERIPH_BASE + 0x0800)
</span>
 <span class="cm">/* GPIOB寄存器地址,强制转换成指针 */</span>
 <span class="cp">#define GPIOA_CRL           *(unsigned int*)(GPIOA_BASE+0x00)
</span> <span class="cp">#define GPIOA_CRH           *(unsigned int*)(GPIOA_BASE+0x04)
</span> <span class="cp">#define GPIOA_IDR           *(unsigned int*)(GPIOA_BASE+0x08)
</span> <span class="cp">#define GPIOA_ODR           *(unsigned int*)(GPIOA_BASE+0x0C)
</span> <span class="cp">#define GPIOA_BSRR          *(unsigned int*)(GPIOA_BASE+0x10)
</span> <span class="cp">#define GPIOA_BRR           *(unsigned int*)(GPIOA_BASE+0x14)
</span> <span class="cp">#define GPIOA_LCKR          *(unsigned int*)(GPIOA_BASE+0x18)
</span>
 <span class="cm">/*RCC外设基地址*/</span>
 <span class="cp">#define RCC_BASE           (AHBPERIPH_BASE + 0x1000)
</span> <span class="cm">/*RCC的AHB1时钟使能寄存器地址,强制转换成指针*/</span>
 <span class="cp">#define RCC_APB2ENR        *(unsigned int*)(RCC_BASE+0x18)
</span></pre></td></tr></tbody></table></code></div></div>
<h3 id="作业-寄存器亮灯"><span class="me-2">作业-寄存器亮灯</span><a href="#作业-寄存器亮灯" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3>
<p>作业内容：使用相应软件操作STM32开发板，用GPIO控制LED发光，用寄存器方式，分别地发射绿光、蓝光，用寄存器方式，控制LED发射黄光、紫光、白光，在黄、紫、白光中任选一种，提交工程压缩包。</p>

<p>首先查询官方操作手册，获取不同颜色LED灯的针脚信息以操作其发出不同颜色的光，创建文件<code class="language-plaintext highlighter-rouge">led.h</code>用于记录宏，之后创建LED控制宏以确保LED正常亮灭、定义一些快速操作的宏，方便后面快速调用颜色：</p>
<div class="language-c highlighter-rouge"><div class="code-header">
        <span data-label-text="C"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
</pre></td><td class="rouge-code"><pre><span class="cp">#ifndef __LED_H
#define __LED_H
</span><span class="cm">/**
 * @author lamaper(Guo Jun Qi 1120241725)
 */</span>

<span class="cp">#include</span> <span class="cpf">"main.h"</span><span class="cp">
</span>
<span class="cm">/* ---------- LED引脚与时钟定义 ---------- */</span>
<span class="c1">// 红色LED（LED1）</span>
<span class="cp">#define LED1_GPIO_PORT    GPIOB
#define LED1_GPIO_PIN     GPIO_PIN_5
#define LED1_CLK_ENABLE() __HAL_RCC_GPIOB_CLK_ENABLE()
</span>
<span class="c1">// 绿色LED（LED2）</span>
<span class="cp">#define LED2_GPIO_PORT    GPIOB
#define LED2_GPIO_PIN     GPIO_PIN_0
#define LED2_CLK_ENABLE() __HAL_RCC_GPIOB_CLK_ENABLE()
</span>
<span class="c1">// 蓝色LED（LED3）</span>
<span class="cp">#define LED3_GPIO_PORT    GPIOB
#define LED3_GPIO_PIN     GPIO_PIN_1
#define LED3_CLK_ENABLE() __HAL_RCC_GPIOB_CLK_ENABLE()
</span>

<span class="cm">/* ---------- LED控制宏（低电平点亮） ---------- */</span>
<span class="cp">#define LED_ON  GPIO_PIN_RESET  // 低电平点亮
#define LED_OFF GPIO_PIN_SET    // 高电平熄灭
</span>
<span class="c1">// 基础控制宏</span>
<span class="cp">#define LED1_SetState(state) HAL_GPIO_WritePin(LED1_GPIO_PORT, LED1_GPIO_PIN, (state))
#define LED2_SetState(state) HAL_GPIO_WritePin(LED2_GPIO_PORT, LED2_GPIO_PIN, (state))
#define LED3_SetState(state) HAL_GPIO_WritePin(LED3_GPIO_PORT, LED3_GPIO_PIN, (state))
</span>
<span class="c1">// 快捷操作宏</span>
<span class="cp">#define LED1_On()  LED1_SetState(LED_ON)
#define LED1_Off() LED1_SetState(LED_OFF)
#define LED1_Toggle() HAL_GPIO_TogglePin(LED1_GPIO_PORT, LED1_GPIO_PIN)
</span>
<span class="cp">#define LED2_On()  LED2_SetState(LED_ON)
#define LED2_Off() LED2_SetState(LED_OFF)
#define LED2_Toggle() HAL_GPIO_TogglePin(LED2_GPIO_PORT, LED2_GPIO_PIN)
</span>
<span class="cp">#define LED3_On()  LED3_SetState(LED_ON)
#define LED3_Off() LED3_SetState(LED_OFF)
#define LED3_Toggle() HAL_GPIO_TogglePin(LED3_GPIO_PORT, LED3_GPIO_PIN)
</span>
<span class="cm">/* ---------- 组合颜色宏 ---------- */</span>
<span class="cp">#define LED_Red()    do { LED1_On();  LED2_Off(); LED3_Off(); } while(0)
#define LED_Green()  do { LED1_Off(); LED2_On();  LED3_Off(); } while(0)
#define LED_Blue()   do { LED1_Off(); LED2_Off(); LED3_On();  } while(0)
#define LED_Yellow() do { LED1_On();  LED2_On();  LED3_Off(); } while(0)
#define LED_Purple() do { LED1_On();  LED2_Off(); LED3_On();  } while(0)
#define LED_Cyan()   do { LED1_Off(); LED2_On();  LED3_On();  } while(0)
#define LED_White()  do { LED1_On();  LED2_On();  LED3_On();  } while(0)
#define LED_RGBOff() do { LED1_Off(); LED2_Off(); LED3_Off(); } while(0)
</span>
<span class="cm">/* ---------- 函数声明 ---------- */</span>
<span class="kt">void</span> <span class="nf">LED_Init</span><span class="p">(</span><span class="kt">void</span><span class="p">);</span>


<span class="cp">#endif </span><span class="cm">/* __LED_H */</span><span class="cp">
</span></pre></td></tr></tbody></table></code></div></div>
<p>在led.c中编辑初始化LED的函数：</p>
<div class="language-c highlighter-rouge"><div class="code-header">
        <span data-label-text="C"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
</pre></td><td class="rouge-code"><pre><span class="cp">#include</span> <span class="cpf">"led.h"</span><span class="cp">
</span>
<span class="cm">/**
 * @author lamaper (Guo Jun Qi 1120241725)
 * @brief 初始化LED对应的GPIO
 * @note 配置为推挽输出、无上下拉、低速
 */</span>
<span class="kt">void</span> <span class="nf">LED_Init</span><span class="p">(</span><span class="kt">void</span><span class="p">)</span>
<span class="p">{</span>
    <span class="n">GPIO_InitTypeDef</span> <span class="n">GPIO_InitStruct</span> <span class="o">=</span> <span class="p">{</span><span class="mi">0</span><span class="p">};</span>

    <span class="c1">// 使能GPIOB时钟</span>
    <span class="n">LED1_CLK_ENABLE</span><span class="p">();</span>
    <span class="n">LED2_CLK_ENABLE</span><span class="p">();</span>
    <span class="n">LED3_CLK_ENABLE</span><span class="p">();</span>

    <span class="c1">// 配置GPIO为推挽输出</span>
    <span class="n">GPIO_InitStruct</span><span class="p">.</span><span class="n">Mode</span> <span class="o">=</span> <span class="n">GPIO_MODE_OUTPUT_PP</span><span class="p">;</span>
    <span class="n">GPIO_InitStruct</span><span class="p">.</span><span class="n">Pull</span> <span class="o">=</span> <span class="n">GPIO_NOPULL</span><span class="p">;</span>
    <span class="n">GPIO_InitStruct</span><span class="p">.</span><span class="n">Speed</span> <span class="o">=</span> <span class="n">GPIO_SPEED_FREQ_LOW</span><span class="p">;</span>

    <span class="c1">// 配置LED1引脚</span>
    <span class="n">GPIO_InitStruct</span><span class="p">.</span><span class="n">Pin</span> <span class="o">=</span> <span class="n">LED1_GPIO_PIN</span><span class="p">;</span>
    <span class="n">HAL_GPIO_Init</span><span class="p">(</span><span class="n">LED1_GPIO_PORT</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">GPIO_InitStruct</span><span class="p">);</span>

    <span class="c1">// 配置LED2引脚</span>
    <span class="n">GPIO_InitStruct</span><span class="p">.</span><span class="n">Pin</span> <span class="o">=</span> <span class="n">LED2_GPIO_PIN</span><span class="p">;</span>
    <span class="n">HAL_GPIO_Init</span><span class="p">(</span><span class="n">LED2_GPIO_PORT</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">GPIO_InitStruct</span><span class="p">);</span>

    <span class="c1">// 配置LED3引脚</span>
    <span class="n">GPIO_InitStruct</span><span class="p">.</span><span class="n">Pin</span> <span class="o">=</span> <span class="n">LED3_GPIO_PIN</span><span class="p">;</span>
    <span class="n">HAL_GPIO_Init</span><span class="p">(</span><span class="n">LED3_GPIO_PORT</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">GPIO_InitStruct</span><span class="p">);</span>

    <span class="c1">// 初始状态：所有LED熄灭</span>
    <span class="n">LED_RGBOff</span><span class="p">();</span>
<span class="p">}</span>
</pre></td></tr></tbody></table></code></div></div>
<p>之后就可以在main函数中配置基础逻辑了：</p>
<div class="language-c highlighter-rouge"><div class="code-header">
        <span data-label-text="C"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
</pre></td><td class="rouge-code"><pre><span class="kt">void</span> <span class="nf">HW1_SpmLight</span><span class="p">(</span><span class="kt">void</span><span class="p">)</span><span class="c1">// 用寄存器的方式，分别地发射绿光、蓝光</span>
<span class="p">{</span>
  <span class="n">LED_Green</span><span class="p">();</span>  <span class="n">HAL_Delay</span><span class="p">(</span><span class="mi">500</span><span class="p">);</span>  <span class="c1">// 绿灯亮500ms</span>
  <span class="n">LED_Blue</span><span class="p">();</span>   <span class="n">HAL_Delay</span><span class="p">(</span><span class="mi">500</span><span class="p">);</span>  <span class="c1">// 蓝灯亮500ms</span>
<span class="p">}</span>
<span class="kt">void</span> <span class="nf">HW1_MixLight</span><span class="p">(</span><span class="kt">void</span><span class="p">)</span> <span class="c1">// 用寄存器的方式，控制LED发射黄光、紫光、白光</span>
<span class="p">{</span>
  <span class="n">LED_Yellow</span><span class="p">();</span> <span class="n">HAL_Delay</span><span class="p">(</span><span class="mi">500</span><span class="p">);</span>  <span class="c1">// 黄灯亮500ms</span>
  <span class="n">LED_Purple</span><span class="p">();</span> <span class="n">HAL_Delay</span><span class="p">(</span><span class="mi">500</span><span class="p">);</span>  <span class="c1">// 紫灯亮500ms</span>
  <span class="n">LED_White</span><span class="p">();</span>  <span class="n">HAL_Delay</span><span class="p">(</span><span class="mi">500</span><span class="p">);</span>  <span class="c1">// 白灯亮500ms</span>
<span class="p">}</span>
<span class="kt">void</span> <span class="nf">HW1_Submit</span><span class="p">(</span><span class="kt">void</span><span class="p">)</span> <span class="c1">// 选择黄光、紫光、白光的任意一种提交工程压缩包</span>
<span class="p">{</span>
  <span class="n">LED_Yellow</span><span class="p">();</span> <span class="c1">// 黄灯长亮</span>
<span class="p">}</span>
</pre></td></tr></tbody></table></code></div></div>
<p>编译运行后可以看到结果：
<a href="https://img2024.cnblogs.com/blog/2914490/202509/2914490-20250908154033897-326732413.png" class="popup img-link shimmer"><img src="https://img2024.cnblogs.com/blog/2914490/202509/2914490-20250908154033897-326732413.png" alt="" loading="lazy"></a></p>

<h3 id="作业-按键与亮灯"><span class="me-2">作业-按键与亮灯</span><a href="#作业-按键与亮灯" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3>
<p>作业内容：使用相应软件操作STM32开发板，使得按KEY1，控制LED灯在“红光-绿光-蓝光-白光”四种方式之间切换按KEY2，控制LED灯熄灭。</p>

<p>首先查询官方操作手册，获取KEY1和KEY2的针脚信息以操作其发出不同颜色的光，创建文件<code class="language-plaintext highlighter-rouge">key.h</code>用于记录宏：</p>
<div class="language-c highlighter-rouge"><div class="code-header">
        <span data-label-text="C"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
</pre></td><td class="rouge-code"><pre><span class="cp">#ifndef __KEY_H
#define __KEY_H
</span>
<span class="cp">#include</span> <span class="cpf">"main.h"</span><span class="cp">
</span>
<span class="cm">/* 按键引脚定义（野火指南者开发板） */</span>
<span class="c1">// KEY1 -&gt; PC13</span>
<span class="cp">#define KEY1_GPIO_PORT    GPIOC
#define KEY1_GPIO_PIN     GPIO_PIN_13
#define KEY1_CLK_ENABLE() __HAL_RCC_GPIOA_CLK_ENABLE()
</span>
<span class="c1">// KEY2 -&gt; PA0</span>
<span class="cp">#define KEY2_GPIO_PORT    GPIOA
#define KEY2_GPIO_PIN     GPIO_PIN_0
#define KEY2_CLK_ENABLE() __HAL_RCC_GPIOC_CLK_ENABLE()
</span>
<span class="cm">/* 函数声明 */</span>
<span class="kt">void</span> <span class="nf">KEY_Init</span><span class="p">(</span><span class="kt">void</span><span class="p">);</span>
<span class="kt">uint8_t</span> <span class="nf">KEY_Scan</span><span class="p">(</span><span class="n">GPIO_TypeDef</span><span class="o">*</span> <span class="n">GPIOx</span><span class="p">,</span> <span class="kt">uint16_t</span> <span class="n">GPIO_Pin</span><span class="p">);</span>

<span class="cp">#endif </span><span class="cm">/* __KEY_H */</span><span class="cp">
</span></pre></td></tr></tbody></table></code></div></div>
<p>单片机中按键检测并没有被封装，因而需要我们自行实现按下的逻辑检测。按键机械触点断开、闭合时，由于触点的弹性作用，按键开关不会马上稳定接通或一下子断开，使用按键时会产生带波纹信号，需要用软件消抖处理滤波，不方便输入检测。</p>

<p><a href="https://img2024.cnblogs.com/blog/2914490/202509/2914490-20250908154240409-446821006.png" class="popup img-link shimmer"><img src="https://img2024.cnblogs.com/blog/2914490/202509/2914490-20250908154240409-446821006.png" alt="" loading="lazy"></a></p>

<p>本此实验采用的野火STM32指南者开发板（STM32F103VET6）板所搭载的按键带硬件消抖功能，它利用电容充放电的延时，消除了波纹，从而简化软件的处理，软件只需要直接检测引脚的电平即可。</p>

<p><a href="https://img2024.cnblogs.com/blog/2914490/202509/2914490-20250908154257541-2118682686.png" class="popup img-link shimmer"><img src="https://img2024.cnblogs.com/blog/2914490/202509/2914490-20250908154257541-2118682686.png" alt="" loading="lazy"></a></p>

<p>从按键的原理图可知，这些按键在没有被按下的时候，GPIO引脚的输入状态为低电平；当按键按下时，GPIO引脚的输入状态为高电平。只要我们检测引脚的输入电平，即可判断按键是否被按下。</p>

<p>基于此在后续创建<code class="language-plaintext highlighter-rouge">key.c</code>控制按键识别，其中KEY_Init函数用来初始化按键，用KEY_Scan函数检测按钮状态，虽然硬件自带抖动消除，但是这里为了练习，使用HAL库的延时函数：</p>
<div class="language-c highlighter-rouge"><div class="code-header">
        <span data-label-text="C"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
</pre></td><td class="rouge-code"><pre><span class="cp">#include</span> <span class="cpf">"key.h"</span><span class="cp">
</span>
<span class="cm">/**
 * @brief 初始化按键GPIO
 */</span>
<span class="kt">void</span> <span class="nf">KEY_Init</span><span class="p">(</span><span class="kt">void</span><span class="p">)</span>
<span class="p">{</span>
    <span class="n">GPIO_InitTypeDef</span> <span class="n">GPIO_InitStruct</span> <span class="o">=</span> <span class="p">{</span><span class="mi">0</span><span class="p">};</span>

    <span class="c1">// 使能按键对应GPIO时钟</span>
    <span class="n">KEY1_CLK_ENABLE</span><span class="p">();</span>
    <span class="n">KEY2_CLK_ENABLE</span><span class="p">();</span>

    <span class="c1">// 配置KEY1（PA0，上拉输入）</span>
    <span class="n">GPIO_InitStruct</span><span class="p">.</span><span class="n">Pin</span> <span class="o">=</span> <span class="n">KEY1_GPIO_PIN</span><span class="p">;</span>
    <span class="n">GPIO_InitStruct</span><span class="p">.</span><span class="n">Mode</span> <span class="o">=</span> <span class="n">GPIO_MODE_INPUT</span><span class="p">;</span>
    <span class="n">GPIO_InitStruct</span><span class="p">.</span><span class="n">Pull</span> <span class="o">=</span> <span class="n">GPIO_PULLUP</span><span class="p">;</span>  <span class="c1">// 上拉输入，按键按下为低电平</span>
    <span class="n">HAL_GPIO_Init</span><span class="p">(</span><span class="n">KEY1_GPIO_PORT</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">GPIO_InitStruct</span><span class="p">);</span>

    <span class="c1">// 配置KEY2（PC13，上拉输入）</span>
    <span class="n">GPIO_InitStruct</span><span class="p">.</span><span class="n">Pin</span> <span class="o">=</span> <span class="n">KEY2_GPIO_PIN</span><span class="p">;</span>
    <span class="n">GPIO_InitStruct</span><span class="p">.</span><span class="n">Mode</span> <span class="o">=</span> <span class="n">GPIO_MODE_INPUT</span><span class="p">;</span>
    <span class="n">GPIO_InitStruct</span><span class="p">.</span><span class="n">Pull</span> <span class="o">=</span> <span class="n">GPIO_PULLUP</span><span class="p">;</span>  <span class="c1">// 上拉输入，按键按下为低电平</span>
    <span class="n">HAL_GPIO_Init</span><span class="p">(</span><span class="n">KEY2_GPIO_PORT</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">GPIO_InitStruct</span><span class="p">);</span>
<span class="p">}</span>

<span class="cm">/**
 * @brief 按键扫描（带消抖，使用HAL_Delay）
 * @param GPIOx: 按键GPIO端口
 * @param GPIO_Pin: 按键GPIO引脚
 * @retval 1: 按键按下（已消抖），0: 未按下
 */</span>
<span class="kt">uint8_t</span> <span class="nf">KEY_Scan</span><span class="p">(</span><span class="n">GPIO_TypeDef</span><span class="o">*</span> <span class="n">GPIOx</span><span class="p">,</span> <span class="kt">uint16_t</span> <span class="n">GPIO_Pin</span><span class="p">)</span>
<span class="p">{</span>
    <span class="k">static</span> <span class="kt">uint8_t</span> <span class="n">key_up</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>  <span class="c1">// 按键松开标志</span>

    <span class="k">if</span> <span class="p">(</span><span class="n">key_up</span> <span class="o">&amp;&amp;</span> <span class="p">(</span><span class="n">HAL_GPIO_ReadPin</span><span class="p">(</span><span class="n">GPIOx</span><span class="p">,</span> <span class="n">GPIO_Pin</span><span class="p">)</span> <span class="o">==</span> <span class="n">GPIO_PIN_RESET</span><span class="p">))</span>
    <span class="p">{</span>
        <span class="n">HAL_Delay</span><span class="p">(</span><span class="mi">20</span><span class="p">);</span>  <span class="c1">// 消抖延时（使用HAL库延迟）</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">HAL_GPIO_ReadPin</span><span class="p">(</span><span class="n">GPIOx</span><span class="p">,</span> <span class="n">GPIO_Pin</span><span class="p">)</span> <span class="o">==</span> <span class="n">GPIO_PIN_RESET</span><span class="p">)</span>
        <span class="p">{</span>
            <span class="n">key_up</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>  <span class="c1">// 标记按键按下</span>
            <span class="k">return</span> <span class="mi">1</span><span class="p">;</span>    <span class="c1">// 返回按下状态</span>
        <span class="p">}</span>
    <span class="p">}</span>
    <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="n">HAL_GPIO_ReadPin</span><span class="p">(</span><span class="n">GPIOx</span><span class="p">,</span> <span class="n">GPIO_Pin</span><span class="p">)</span> <span class="o">==</span> <span class="n">GPIO_PIN_SET</span><span class="p">)</span>
    <span class="p">{</span>
        <span class="n">HAL_Delay</span><span class="p">(</span><span class="mi">20</span><span class="p">);</span>  <span class="c1">// 消抖延时</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">HAL_GPIO_ReadPin</span><span class="p">(</span><span class="n">GPIOx</span><span class="p">,</span> <span class="n">GPIO_Pin</span><span class="p">)</span> <span class="o">==</span> <span class="n">GPIO_PIN_SET</span><span class="p">)</span>
        <span class="p">{</span>
            <span class="n">key_up</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>  <span class="c1">// 标记按键松开</span>
        <span class="p">}</span>
    <span class="p">}</span>
    <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>  <span class="c1">// 未按下</span>
<span class="p">}</span>
</pre></td></tr></tbody></table></code></div></div>
<p>之后就可以在main函数中配置基础逻辑了。</p>
<div class="language-c highlighter-rouge"><div class="code-header">
        <span data-label-text="C"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
</pre></td><td class="rouge-code"><pre><span class="kt">void</span> <span class="nf">HW2</span><span class="p">(</span><span class="kt">void</span><span class="p">)</span> <span class="p">{</span>
  <span class="k">if</span> <span class="p">(</span><span class="n">mode</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
    <span class="n">LED_RGBOff</span><span class="p">();</span>
    <span class="n">mode</span> <span class="o">+=</span> <span class="mi">1</span><span class="p">;</span>
  <span class="p">}</span>
  <span class="c1">// 作业2：KEY1切换模式（红光→绿光→蓝光→白光循环）</span>
  <span class="k">if</span> <span class="p">(</span><span class="n">KEY_Scan</span><span class="p">(</span><span class="n">KEY1_GPIO_PORT</span><span class="p">,</span> <span class="n">KEY1_GPIO_PIN</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">)</span>
  <span class="p">{</span>
    <span class="n">current_mode</span><span class="o">++</span><span class="p">;</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">current_mode</span> <span class="o">&gt;=</span> <span class="mi">4</span><span class="p">)</span>  <span class="c1">// 超过白光模式(3)则回到红光(0)</span>
      <span class="n">current_mode</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>

    <span class="c1">// 根据当前模式切换LED（直接使用led.h中的宏）</span>
    <span class="k">switch</span><span class="p">(</span><span class="n">current_mode</span><span class="p">)</span>
    <span class="p">{</span>
      <span class="k">case</span> <span class="mi">0</span><span class="p">:</span> <span class="n">LED_Red</span><span class="p">();</span><span class="n">HAL_Delay</span><span class="p">(</span><span class="mi">200</span><span class="p">);</span>    <span class="k">break</span><span class="p">;</span>
      <span class="k">case</span> <span class="mi">1</span><span class="p">:</span> <span class="n">LED_Green</span><span class="p">();</span><span class="n">HAL_Delay</span><span class="p">(</span><span class="mi">200</span><span class="p">);</span>  <span class="k">break</span><span class="p">;</span>
      <span class="k">case</span> <span class="mi">2</span><span class="p">:</span> <span class="n">LED_Blue</span><span class="p">();</span><span class="n">HAL_Delay</span><span class="p">(</span><span class="mi">200</span><span class="p">);</span>   <span class="k">break</span><span class="p">;</span>
      <span class="k">case</span> <span class="mi">3</span><span class="p">:</span> <span class="n">LED_White</span><span class="p">();</span><span class="n">HAL_Delay</span><span class="p">(</span><span class="mi">200</span><span class="p">);</span>  <span class="k">break</span><span class="p">;</span>
      <span class="nl">default:</span> <span class="n">LED_RGBOff</span><span class="p">();</span><span class="k">break</span><span class="p">;</span>
    <span class="p">}</span>
  <span class="p">}</span>

  <span class="c1">// 作业2：KEY2熄灭LED</span>
  <span class="k">if</span> <span class="p">(</span><span class="n">KEY_Scan</span><span class="p">(</span><span class="n">KEY2_GPIO_PORT</span><span class="p">,</span> <span class="n">KEY2_GPIO_PIN</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">)</span>
  <span class="p">{</span>
    <span class="n">current_mode</span> <span class="o">=</span> <span class="mi">4</span><span class="p">;</span>  <span class="c1">// 标记为熄灭模式</span>
    <span class="n">LED_RGBOff</span><span class="p">();</span>
  <span class="p">}</span>

  <span class="n">HAL_Delay</span><span class="p">(</span><span class="mi">10</span><span class="p">);</span>  <span class="c1">// 消抖延时</span>
<span class="p">}</span>
</pre></td></tr></tbody></table></code></div></div>

<h3 id="作业-蜂鸣器"><span class="me-2">作业-蜂鸣器</span><a href="#作业-蜂鸣器" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3>
<p>作业内容：使用相应软件操作STM32开发板，写一个函数，使用SysTick方法，计时0.25s使蜂鸣器产生n次短鸣+1长鸣，n=mod(学号末位)+1短鸣的时间为0.25s，长鸣时间为1s，每次鸣响之间间隔1s蜂鸣响起的同时，红色LED灯同时亮起。</p>

<p>我的学号末尾是5，后面采用5。</p>

<p>首先查询官方操作手册，获取蜂鸣器的针脚信息，创建文件beep.h用于记录宏，通过查询该开发板的<a href="https://doc.embedfire.com/release/selection_guide/zh/latest/_downloads/cbb914a3fb08877b29d6977584f21866/selection_guide.pdf">技术手册</a>可以得知，这块开发板采用有源蜂鸣器。STM32 驱动蜂鸣器的核心原理，是通过GPIO 引脚输出控制信号，配合蜂鸣器自身的发声结构，最终将电信号转化为声音信号。对于有源蜂鸣器，其内部自带振荡电路且包含芯片，只需GPIO输出高低电平——通电响、断电停——即可使其发声。基于此，定义如下宏以方便开发：</p>
<div class="language-c highlighter-rouge"><div class="code-header">
        <span data-label-text="C"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
</pre></td><td class="rouge-code"><pre><span class="cp">#ifndef __BEEP_H
#define __BEEP_H
</span>
<span class="cp">#include</span> <span class="cpf">"main.h"</span><span class="cp">
#include</span> <span class="cpf">"led.h"</span><span class="cp">
</span><span class="c1">// 用于控制红色LED（LED1）</span>

<span class="cm">/* ---------- 蜂鸣器硬件配置 ---------- */</span>
<span class="cp">#define BEEP_GPIO_PORT        GPIOA                   </span><span class="cm">/* 蜂鸣器GPIO端口 */</span><span class="cp">
#define BEEP_GPIO_PIN         GPIO_PIN_8              </span><span class="cm">/* 蜂鸣器GPIO引脚 */</span><span class="cp">
#define BEEP_GPIO_CLK_ENABLE() __HAL_RCC_GPIOA_CLK_ENABLE()  </span><span class="cm">/* 蜂鸣器时钟使能 */</span><span class="cp">
</span>
<span class="cm">/* 蜂鸣器控制宏（高电平触发鸣响） */</span>
<span class="cp">#define BEEP_ON  GPIO_PIN_SET
#define BEEP_OFF GPIO_PIN_RESET
#define BEEP_SetState(state) HAL_GPIO_WritePin(BEEP_GPIO_PORT, BEEP_GPIO_PIN, (state))
#define BEEP_On()  BEEP_SetState(BEEP_ON)
#define BEEP_Off() BEEP_SetState(BEEP_OFF)
</span>
<span class="cm">/* 函数声明 */</span>
<span class="kt">void</span> <span class="nf">BEEP_Init</span><span class="p">(</span><span class="kt">void</span><span class="p">);</span>                    <span class="c1">// 蜂鸣器GPIO初始化</span>
<span class="kt">void</span> <span class="nf">BEEP_AlarmWithLED</span><span class="p">(</span><span class="kt">uint8_t</span> <span class="n">n</span><span class="p">);</span>       <span class="c1">// 1次短鸣 + 1次长鸣（同步红色LED亮灭）</span>

<span class="cp">#endif </span><span class="cm">/* __BEEP_H */</span><span class="cp">
</span></pre></td></tr></tbody></table></code></div></div>

<p>在<code class="language-plaintext highlighter-rouge">beep.c</code>中实现头文件中定义的函数。首先是初始化蜂鸣器的GPIO，最后实现蜂鸣器鸣叫函数：</p>

<div class="language-c highlighter-rouge"><div class="code-header">
        <span data-label-text="C"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
</pre></td><td class="rouge-code"><pre><span class="cp">#include</span> <span class="cpf">"beep.h"</span><span class="cp">
</span>
<span class="cm">/* 蜂鸣器GPIO初始化：配置为推挽输出 */</span>
<span class="kt">void</span> <span class="nf">BEEP_Init</span><span class="p">(</span><span class="kt">void</span><span class="p">)</span>
<span class="p">{</span>
    <span class="n">GPIO_InitTypeDef</span> <span class="n">GPIO_InitStruct</span> <span class="o">=</span> <span class="p">{</span><span class="mi">0</span><span class="p">};</span>

    <span class="cm">/* 使能蜂鸣器GPIO时钟 */</span>
    <span class="n">BEEP_GPIO_CLK_ENABLE</span><span class="p">();</span>

    <span class="cm">/* 配置蜂鸣器引脚为推挽输出 */</span>
    <span class="n">GPIO_InitStruct</span><span class="p">.</span><span class="n">Pin</span> <span class="o">=</span> <span class="n">BEEP_GPIO_PIN</span><span class="p">;</span>
    <span class="n">GPIO_InitStruct</span><span class="p">.</span><span class="n">Mode</span> <span class="o">=</span> <span class="n">GPIO_MODE_OUTPUT_PP</span><span class="p">;</span>   <span class="c1">// 推挽输出</span>
    <span class="n">GPIO_InitStruct</span><span class="p">.</span><span class="n">Pull</span> <span class="o">=</span> <span class="n">GPIO_NOPULL</span><span class="p">;</span>           <span class="c1">// 无上下拉</span>
    <span class="n">GPIO_InitStruct</span><span class="p">.</span><span class="n">Speed</span> <span class="o">=</span> <span class="n">GPIO_SPEED_FREQ_LOW</span><span class="p">;</span>  <span class="c1">// 低速</span>
    <span class="n">HAL_GPIO_Init</span><span class="p">(</span><span class="n">BEEP_GPIO_PORT</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">GPIO_InitStruct</span><span class="p">);</span>

    <span class="cm">/* 初始状态：蜂鸣器关闭 */</span>
    <span class="n">BEEP_Off</span><span class="p">();</span>
<span class="p">}</span>

<span class="cm">/* 蜂鸣器鸣响+LED同步逻辑：n次短鸣(0.25s) + 1次长鸣(1s) */</span>
<span class="kt">void</span> <span class="nf">BEEP_AlarmWithLED</span><span class="p">(</span><span class="kt">uint8_t</span> <span class="n">n</span><span class="p">)</span>
<span class="p">{</span>
    <span class="kt">uint8_t</span> <span class="n">i</span><span class="p">;</span>

    <span class="cm">/* 计算n：n = mod(学号末位,5) + 1 →
     * 我的学号末位为5，即n = 5%5 +1 = 1 */</span>
    <span class="n">n</span> <span class="o">=</span> <span class="p">(</span><span class="n">n</span> <span class="o">%</span> <span class="mi">5</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">;</span>

    <span class="cm">/* 执行n次“短鸣+间隔” */</span>
    <span class="k">for</span> <span class="p">(</span><span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">n</span><span class="p">;</span> <span class="n">i</span><span class="o">++</span><span class="p">)</span>
    <span class="p">{</span>
        <span class="n">BEEP_On</span><span class="p">();</span>   <span class="c1">// 蜂鸣器响</span>
        <span class="n">LED1_On</span><span class="p">();</span>   <span class="c1">// 红色LED亮</span>
        <span class="n">HAL_Delay</span><span class="p">(</span><span class="mi">250</span><span class="p">);</span>  <span class="c1">// 短鸣持续0.25s</span>

        <span class="n">BEEP_Off</span><span class="p">();</span>  <span class="c1">// 蜂鸣器关</span>
        <span class="n">LED1_Off</span><span class="p">();</span>  <span class="c1">// 红色LED灭</span>
        <span class="n">HAL_Delay</span><span class="p">(</span><span class="mi">1000</span><span class="p">);</span> <span class="c1">// 短鸣间隔1s</span>
    <span class="p">}</span>

    <span class="cm">/* 执行1次“长鸣” */</span>
    <span class="n">BEEP_On</span><span class="p">();</span>
    <span class="n">LED1_On</span><span class="p">();</span>
    <span class="n">HAL_Delay</span><span class="p">(</span><span class="mi">1000</span><span class="p">);</span> <span class="c1">// 长鸣持续1s</span>

    <span class="cm">/* 结束后关闭蜂鸣器和LED */</span>
    <span class="n">BEEP_Off</span><span class="p">();</span>
    <span class="n">LED1_Off</span><span class="p">();</span>
<span class="p">}</span>
</pre></td></tr></tbody></table></code></div></div>

<h3 id="作业-串口通信"><span class="me-2">作业-串口通信</span><a href="#作业-串口通信" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3>
<p>作业内容：使用相应软件操作STM32开发板，用直接配置串口的方式，向PC传输一句话在FLASH中存储一句话，并用DMA配置串口向PC传输。</p>

<p>串口通讯是一种设备间非常常用的串行通讯方式，因为它简单便捷，因此大部分电子设备都支持该通讯方式，电子工程师在调试设备时也经常使用该通讯方式输出调试信息。</p>

<p>USART（Universal Synchronous/Asynchronous Receiver/Transmitter）是 STM32 芯片里的一种串行通信外设。它的主要功能就是把数据（字节）转换成一位一位的电平信号，通过TX引脚发出去，或者从RX引脚接收一位一位的电平信号，再拼成字节给CPU。在本实验中，只用到USART1的异步模式，即串口通信。</p>

<p>基于上述原理，创建文件usart.h用于记录宏：</p>
<div class="language-c highlighter-rouge"><div class="code-header">
        <span data-label-text="C"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
</pre></td><td class="rouge-code"><pre><span class="c1">//</span>
<span class="c1">// Created by lamaper on 2025/9/2.</span>
<span class="c1">//</span>

<span class="cp">#ifndef __USART_H
#define __USART_H
</span>
<span class="cp">#include</span> <span class="cpf">"stm32f1xx_hal.h"</span><span class="cp">
#include</span> <span class="cpf">"stm32f1xx_hal_uart.h"</span><span class="cp">
#include</span> <span class="cpf">&lt;string.h&gt;</span><span class="cp">
</span>
<span class="cm">/* 外部句柄 */</span>
<span class="k">extern</span> <span class="n">UART_HandleTypeDef</span> <span class="n">huart1</span><span class="p">;</span>
<span class="k">extern</span> <span class="n">DMA_HandleTypeDef</span> <span class="n">hdma_tx</span><span class="p">;</span>

<span class="cm">/* 初始化 */</span>
<span class="kt">void</span> <span class="nf">USART1_UART_Init</span><span class="p">(</span><span class="kt">void</span><span class="p">);</span>

<span class="cm">/* 普通发送 */</span>
<span class="kt">void</span> <span class="nf">UART_SendString</span><span class="p">(</span><span class="kt">char</span> <span class="o">*</span><span class="n">str</span><span class="p">);</span>

<span class="cm">/* DMA 发送 */</span>
<span class="kt">void</span> <span class="nf">UART_SendString_DMA</span><span class="p">(</span><span class="kt">char</span> <span class="o">*</span><span class="n">str</span><span class="p">);</span>

<span class="cp">#endif </span><span class="cm">/* __USART_H */</span><span class="cp">
</span></pre></td></tr></tbody></table></code></div></div>

<p>之后开始编写初始化usart函数，首先开启USART1、GPIOA、DMA1时钟,之后配置引脚，在STM32F103系列芯片中，统一规定了USART1的引脚是PA9（TX，发送）和PA10（RX，接收）。在此处设置TX为复用推挽，使其能输出波形；RX作为输入，设为上拉状态，记为空闲。然后配置通信格式。</p>
<div class="language-c highlighter-rouge"><div class="code-header">
        <span data-label-text="C"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
</pre></td><td class="rouge-code"><pre><span class="c1">//</span>
<span class="c1">// Created by lamaper on 2025/9/2.</span>
<span class="c1">//</span>

<span class="cp">#include</span> <span class="cpf">"usart.h"</span><span class="cp">
</span>
<span class="n">UART_HandleTypeDef</span> <span class="n">huart1</span><span class="p">;</span>
<span class="n">DMA_HandleTypeDef</span> <span class="n">hdma_tx</span><span class="p">;</span>

<span class="kt">void</span> <span class="nf">USART1_UART_Init</span><span class="p">(</span><span class="kt">void</span><span class="p">)</span>
<span class="p">{</span>
    <span class="n">__HAL_RCC_USART1_CLK_ENABLE</span><span class="p">();</span>
    <span class="n">__HAL_RCC_GPIOA_CLK_ENABLE</span><span class="p">();</span>
    <span class="n">__HAL_RCC_DMA1_CLK_ENABLE</span><span class="p">();</span>

    <span class="cm">/* PA9 = TX, PA10 = RX */</span>
    <span class="n">GPIO_InitTypeDef</span> <span class="n">GPIO_InitStruct</span> <span class="o">=</span> <span class="p">{</span><span class="mi">0</span><span class="p">};</span>

    <span class="n">GPIO_InitStruct</span><span class="p">.</span><span class="n">Pin</span> <span class="o">=</span> <span class="n">GPIO_PIN_9</span><span class="p">;</span>
    <span class="n">GPIO_InitStruct</span><span class="p">.</span><span class="n">Mode</span> <span class="o">=</span> <span class="n">GPIO_MODE_AF_PP</span><span class="p">;</span>
    <span class="n">GPIO_InitStruct</span><span class="p">.</span><span class="n">Speed</span> <span class="o">=</span> <span class="n">GPIO_SPEED_FREQ_HIGH</span><span class="p">;</span>
    <span class="n">HAL_GPIO_Init</span><span class="p">(</span><span class="n">GPIOA</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">GPIO_InitStruct</span><span class="p">);</span>

    <span class="n">GPIO_InitStruct</span><span class="p">.</span><span class="n">Pin</span> <span class="o">=</span> <span class="n">GPIO_PIN_10</span><span class="p">;</span>
    <span class="n">GPIO_InitStruct</span><span class="p">.</span><span class="n">Mode</span> <span class="o">=</span> <span class="n">GPIO_MODE_INPUT</span><span class="p">;</span>
    <span class="n">GPIO_InitStruct</span><span class="p">.</span><span class="n">Pull</span> <span class="o">=</span> <span class="n">GPIO_NOPULL</span><span class="p">;</span>
    <span class="n">HAL_GPIO_Init</span><span class="p">(</span><span class="n">GPIOA</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">GPIO_InitStruct</span><span class="p">);</span>

    <span class="cm">/* USART1 配置: 115200 8N1 */</span>
    <span class="n">huart1</span><span class="p">.</span><span class="n">Instance</span> <span class="o">=</span> <span class="n">USART1</span><span class="p">;</span>
    <span class="n">huart1</span><span class="p">.</span><span class="n">Init</span><span class="p">.</span><span class="n">BaudRate</span> <span class="o">=</span> <span class="mi">115200</span><span class="p">;</span>
    <span class="n">huart1</span><span class="p">.</span><span class="n">Init</span><span class="p">.</span><span class="n">WordLength</span> <span class="o">=</span> <span class="n">UART_WORDLENGTH_8B</span><span class="p">;</span>
    <span class="n">huart1</span><span class="p">.</span><span class="n">Init</span><span class="p">.</span><span class="n">StopBits</span> <span class="o">=</span> <span class="n">UART_STOPBITS_1</span><span class="p">;</span>
    <span class="n">huart1</span><span class="p">.</span><span class="n">Init</span><span class="p">.</span><span class="n">Parity</span> <span class="o">=</span> <span class="n">UART_PARITY_NONE</span><span class="p">;</span>
    <span class="n">huart1</span><span class="p">.</span><span class="n">Init</span><span class="p">.</span><span class="n">Mode</span> <span class="o">=</span> <span class="n">UART_MODE_TX_RX</span><span class="p">;</span>
    <span class="n">huart1</span><span class="p">.</span><span class="n">Init</span><span class="p">.</span><span class="n">HwFlowCtl</span> <span class="o">=</span> <span class="n">UART_HWCONTROL_NONE</span><span class="p">;</span>
    <span class="n">huart1</span><span class="p">.</span><span class="n">Init</span><span class="p">.</span><span class="n">OverSampling</span> <span class="o">=</span> <span class="n">UART_OVERSAMPLING_16</span><span class="p">;</span>
    <span class="n">HAL_UART_Init</span><span class="p">(</span><span class="o">&amp;</span><span class="n">huart1</span><span class="p">);</span>

    <span class="cm">/* DMA 配置: USART1_TX = DMA1_Channel4 */</span>
    <span class="n">hdma_tx</span><span class="p">.</span><span class="n">Instance</span> <span class="o">=</span> <span class="n">DMA1_Channel4</span><span class="p">;</span>
    <span class="n">hdma_tx</span><span class="p">.</span><span class="n">Init</span><span class="p">.</span><span class="n">Direction</span> <span class="o">=</span> <span class="n">DMA_MEMORY_TO_PERIPH</span><span class="p">;</span>
    <span class="n">hdma_tx</span><span class="p">.</span><span class="n">Init</span><span class="p">.</span><span class="n">PeriphInc</span> <span class="o">=</span> <span class="n">DMA_PINC_DISABLE</span><span class="p">;</span>
    <span class="n">hdma_tx</span><span class="p">.</span><span class="n">Init</span><span class="p">.</span><span class="n">MemInc</span> <span class="o">=</span> <span class="n">DMA_MINC_ENABLE</span><span class="p">;</span>
    <span class="n">hdma_tx</span><span class="p">.</span><span class="n">Init</span><span class="p">.</span><span class="n">PeriphDataAlignment</span> <span class="o">=</span> <span class="n">DMA_PDATAALIGN_BYTE</span><span class="p">;</span>
    <span class="n">hdma_tx</span><span class="p">.</span><span class="n">Init</span><span class="p">.</span><span class="n">MemDataAlignment</span> <span class="o">=</span> <span class="n">DMA_MDATAALIGN_BYTE</span><span class="p">;</span>
    <span class="n">hdma_tx</span><span class="p">.</span><span class="n">Init</span><span class="p">.</span><span class="n">Mode</span> <span class="o">=</span> <span class="n">DMA_NORMAL</span><span class="p">;</span>
    <span class="n">hdma_tx</span><span class="p">.</span><span class="n">Init</span><span class="p">.</span><span class="n">Priority</span> <span class="o">=</span> <span class="n">DMA_PRIORITY_LOW</span><span class="p">;</span>
    <span class="n">HAL_DMA_Init</span><span class="p">(</span><span class="o">&amp;</span><span class="n">hdma_tx</span><span class="p">);</span>

    <span class="n">__HAL_LINKDMA</span><span class="p">(</span><span class="o">&amp;</span><span class="n">huart1</span><span class="p">,</span> <span class="n">hdmatx</span><span class="p">,</span> <span class="n">hdma_tx</span><span class="p">);</span>

    <span class="cm">/* DMA NVIC */</span>
    <span class="n">HAL_NVIC_SetPriority</span><span class="p">(</span><span class="n">DMA1_Channel4_IRQn</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">);</span>
    <span class="n">HAL_NVIC_EnableIRQ</span><span class="p">(</span><span class="n">DMA1_Channel4_IRQn</span><span class="p">);</span>
<span class="p">}</span>

<span class="kt">void</span> <span class="nf">UART_SendString</span><span class="p">(</span><span class="kt">char</span> <span class="o">*</span><span class="n">str</span><span class="p">)</span>
<span class="p">{</span>
    <span class="n">HAL_UART_Transmit</span><span class="p">(</span><span class="o">&amp;</span><span class="n">huart1</span><span class="p">,</span> <span class="p">(</span><span class="kt">uint8_t</span><span class="o">*</span><span class="p">)</span><span class="n">str</span><span class="p">,</span> <span class="n">strlen</span><span class="p">(</span><span class="n">str</span><span class="p">),</span> <span class="n">HAL_MAX_DELAY</span><span class="p">);</span>
<span class="p">}</span>

<span class="kt">void</span> <span class="nf">UART_SendString_DMA</span><span class="p">(</span><span class="kt">char</span> <span class="o">*</span><span class="n">str</span><span class="p">)</span>
<span class="p">{</span>
    <span class="n">HAL_UART_Transmit_DMA</span><span class="p">(</span><span class="o">&amp;</span><span class="n">huart1</span><span class="p">,</span> <span class="p">(</span><span class="kt">uint8_t</span><span class="o">*</span><span class="p">)</span><span class="n">str</span><span class="p">,</span> <span class="n">strlen</span><span class="p">(</span><span class="n">str</span><span class="p">));</span>
<span class="p">}</span>

</pre></td></tr></tbody></table></code></div></div>

<p>STM32F1 的主存储器是片上Flash，既用来存程序，也能存数据。其掉电不丢失，适合存储固定配置；Flash以页为单位擦除，不能只擦除一个字节；以半字，即16bit为最小写入单位，必须2字节对齐。如果要操作，首先要解锁Flash，然后擦除页使其恢复0xFF，之后逐字（半字）写入数据，最后锁上Flash。</p>

<p>在flash.h中声明两个函数负责读写，同时选一个安全带页地址，本文选择STM32F103VET6 最后2K的起始地址（0x0807F800U）：</p>
<div class="language-c highlighter-rouge"><div class="code-header">
        <span data-label-text="C"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
</pre></td><td class="rouge-code"><pre><span class="c1">//</span>
<span class="c1">// Created by lamaper on 2025/9/2.</span>
<span class="c1">//</span>

<span class="cp">#ifndef __FLASH_H
#define __FLASH_H
</span>
<span class="cp">#include</span> <span class="cpf">"stm32f1xx_hal.h"</span><span class="cp">
#include</span> <span class="cpf">&lt;string.h&gt;</span><span class="cp">
</span>
<span class="cm">/* 选一个安全的页地址（比如最后一页） */</span>
<span class="cp">#define FLASH_PAGE_ADDR 0x0807F800U  // STM32F103VET6 最后 2K 的起始地址
</span>
<span class="kt">void</span> <span class="nf">Flash_Write</span><span class="p">(</span><span class="kt">uint32_t</span> <span class="n">addr</span><span class="p">,</span> <span class="kt">uint8_t</span> <span class="o">*</span><span class="n">data</span><span class="p">,</span> <span class="kt">uint16_t</span> <span class="n">len</span><span class="p">);</span>
<span class="kt">void</span> <span class="nf">Flash_Read</span><span class="p">(</span><span class="kt">uint32_t</span> <span class="n">addr</span><span class="p">,</span> <span class="kt">uint8_t</span> <span class="o">*</span><span class="n">buf</span><span class="p">,</span> <span class="kt">uint16_t</span> <span class="n">len</span><span class="p">);</span>

<span class="cp">#endif </span><span class="cm">/* __FLASH_H */</span><span class="cp">
</span></pre></td></tr></tbody></table></code></div></div>

<p>在flash.c中实现他们：</p>
<div class="language-c highlighter-rouge"><div class="code-header">
        <span data-label-text="C"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
</pre></td><td class="rouge-code"><pre><span class="c1">//</span>
<span class="c1">// Created by lamaper on 2025/9/2.</span>
<span class="c1">//</span>

<span class="cp">#include</span> <span class="cpf">"flash.h"</span><span class="cp">
</span>
<span class="kt">void</span> <span class="nf">Flash_Write</span><span class="p">(</span><span class="kt">uint32_t</span> <span class="n">addr</span><span class="p">,</span> <span class="kt">uint8_t</span> <span class="o">*</span><span class="n">data</span><span class="p">,</span> <span class="kt">uint16_t</span> <span class="n">len</span><span class="p">)</span>
<span class="p">{</span>
    <span class="n">HAL_FLASH_Unlock</span><span class="p">();</span>

    <span class="cm">/* 先擦除页（注意：Flash 必须先擦才能重新写） */</span>
    <span class="n">FLASH_EraseInitTypeDef</span> <span class="n">erase</span> <span class="o">=</span> <span class="p">{</span><span class="mi">0</span><span class="p">};</span>
    <span class="kt">uint32_t</span> <span class="n">pageError</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
    <span class="n">erase</span><span class="p">.</span><span class="n">TypeErase</span> <span class="o">=</span> <span class="n">FLASH_TYPEERASE_PAGES</span><span class="p">;</span>
    <span class="n">erase</span><span class="p">.</span><span class="n">PageAddress</span> <span class="o">=</span> <span class="n">FLASH_PAGE_ADDR</span><span class="p">;</span>
    <span class="n">erase</span><span class="p">.</span><span class="n">NbPages</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
    <span class="n">HAL_FLASHEx_Erase</span><span class="p">(</span><span class="o">&amp;</span><span class="n">erase</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">pageError</span><span class="p">);</span>

    <span class="cm">/* 半字写入 */</span>
    <span class="k">for</span> <span class="p">(</span><span class="kt">uint16_t</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">len</span><span class="p">;</span> <span class="n">i</span> <span class="o">+=</span> <span class="mi">2</span><span class="p">)</span>
    <span class="p">{</span>
        <span class="kt">uint16_t</span> <span class="n">halfword</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="n">i</span><span class="p">];</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span> <span class="o">&lt;</span> <span class="n">len</span><span class="p">)</span> <span class="n">halfword</span> <span class="o">|=</span> <span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span> <span class="o">&lt;&lt;</span> <span class="mi">8</span><span class="p">);</span>
        <span class="n">HAL_FLASH_Program</span><span class="p">(</span><span class="n">FLASH_TYPEPROGRAM_HALFWORD</span><span class="p">,</span> <span class="n">addr</span> <span class="o">+</span> <span class="n">i</span><span class="p">,</span> <span class="n">halfword</span><span class="p">);</span>
    <span class="p">}</span>

    <span class="n">HAL_FLASH_Lock</span><span class="p">();</span>
<span class="p">}</span>

<span class="kt">void</span> <span class="nf">Flash_Read</span><span class="p">(</span><span class="kt">uint32_t</span> <span class="n">addr</span><span class="p">,</span> <span class="kt">uint8_t</span> <span class="o">*</span><span class="n">buf</span><span class="p">,</span> <span class="kt">uint16_t</span> <span class="n">len</span><span class="p">)</span>
<span class="p">{</span>
    <span class="k">for</span> <span class="p">(</span><span class="kt">uint16_t</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">len</span><span class="p">;</span> <span class="n">i</span><span class="o">++</span><span class="p">)</span>
    <span class="p">{</span>
        <span class="n">buf</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="o">*</span><span class="p">(</span><span class="k">volatile</span> <span class="kt">uint8_t</span><span class="o">*</span><span class="p">)(</span><span class="n">addr</span> <span class="o">+</span> <span class="n">i</span><span class="p">);</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></td></tr></tbody></table></code></div></div>

<p>之后就可以在main函数中配置基础逻辑了：</p>
<div class="language-c highlighter-rouge"><div class="code-header">
        <span data-label-text="C"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
</pre></td><td class="rouge-code"><pre><span class="kt">void</span> <span class="nf">HW4</span><span class="p">(</span><span class="kt">void</span><span class="p">)</span> <span class="p">{</span>
  <span class="n">USART1_UART_Init</span><span class="p">();</span>

  <span class="cm">/* 1. 普通发送 */</span>
  <span class="n">UART_SendString</span><span class="p">(</span><span class="s">"Hello, I'm lamaper! This is UART direct send!</span><span class="se">\r\n</span><span class="s">"</span><span class="p">);</span>

  <span class="cm">/* 2. Flash 存储一句话 */</span>
  <span class="kt">char</span> <span class="n">msg</span><span class="p">[]</span> <span class="o">=</span> <span class="s">"Hello from Flash + DMA!</span><span class="se">\r\n</span><span class="s">"</span><span class="p">;</span>
  <span class="n">Flash_Write</span><span class="p">(</span><span class="n">FLASH_PAGE_ADDR</span><span class="p">,</span> <span class="p">(</span><span class="kt">uint8_t</span><span class="o">*</span><span class="p">)</span><span class="n">msg</span><span class="p">,</span> <span class="n">strlen</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span><span class="o">+</span><span class="mi">1</span><span class="p">);</span>

  <span class="cm">/* 3. 读回并用 DMA 发送 */</span>
  <span class="kt">char</span> <span class="n">buf</span><span class="p">[</span><span class="mi">64</span><span class="p">];</span>
  <span class="n">Flash_Read</span><span class="p">(</span><span class="n">FLASH_PAGE_ADDR</span><span class="p">,</span> <span class="p">(</span><span class="kt">uint8_t</span><span class="o">*</span><span class="p">)</span><span class="n">buf</span><span class="p">,</span> <span class="n">strlen</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span><span class="o">+</span><span class="mi">1</span><span class="p">);</span>
  <span class="n">UART_SendString_DMA</span><span class="p">(</span><span class="n">buf</span><span class="p">);</span>
<span class="p">}</span>
</pre></td></tr></tbody></table></code></div></div>
<p>此外，注意到电脑本身并没有串口监控程序，需要单另下载，因而在Microsoft Store中下载相关工具，启动串口监听，有如下结果：
<a href="https://img2024.cnblogs.com/blog/2914490/202509/2914490-20250908155822439-1732845926.png" class="popup img-link shimmer"><img src="https://img2024.cnblogs.com/blog/2914490/202509/2914490-20250908155822439-1732845926.png" alt="46541a11663cc8b9da7217d985890d27" loading="lazy"></a>
<a href="https://img2024.cnblogs.com/blog/2914490/202509/2914490-20250908155900023-455134809.png" class="popup img-link shimmer"><img src="https://img2024.cnblogs.com/blog/2914490/202509/2914490-20250908155900023-455134809.png" alt="" loading="lazy"></a></p>

<h3 id="作业-七彩灯"><span class="me-2">作业-七彩灯</span><a href="#作业-七彩灯" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3>
<p>作业内容：使用相应软件操作STM32开发板，以TIM3输出PWM，控制全彩LED灯变换颜色以另一个TIM作为计数器，每1s产生1次中断以中断控制一个状态机，改变全彩灯的CCR达到效果：赤-橙-黄-绿-青-蓝-紫，七种颜色循环切换，每1s切换一个颜色。</p>

<p>PWM 是 Pulse Width Modulation（脉冲宽度调制）的缩写，是一种通过改变脉冲信号的高电平持续时间与周期的比例，来模拟信号效果的数字控制技术。STM32 的定时器，如TIM3，可硬件生成高精度 PWM 信号，无需 CPU 持续干预。对 LED 来说，在频率足够高的情况下，人眼会因为视觉暂留把高频闪烁看作持续的光。TIMx作为PWM的时基有频率公式：
\(f_{PWM} = \frac{f_{TIMCLK}}{(PSC+1) \times (ARR+1)}\)</p>

<p>其中ARR为自动重装载寄存器，决定周期长度，即计数上限；PSC为预分频器，决定计数节拍变慢多少；CRR是捕获/比较寄存器，对应占空比。在STM32F103系列芯片中，TIM3有多个通道能做PWM，通过重映射可以把它们映射到开发板的引脚上：</p>
<div class="language-c highlighter-rouge"><div class="code-header">
        <span data-label-text="C"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
</pre></td><td class="rouge-code"><pre><span class="c1">//</span>
<span class="c1">// Created by lamaper on 2025/9/2.</span>
<span class="c1">//</span>

<span class="cp">#ifndef __TIM_H
#define __TIM_H
</span>
<span class="cp">#include</span> <span class="cpf">"stm32f1xx_hal.h"</span><span class="c1">      // HAL 基础</span><span class="cp">
#include</span> <span class="cpf">"stm32f1xx_hal_tim.h"</span><span class="c1">  // TIM HAL</span><span class="cp">
</span>
<span class="cm">/* 全局句柄（只声明） */</span>
<span class="k">extern</span> <span class="n">TIM_HandleTypeDef</span> <span class="n">htim3</span><span class="p">;</span> <span class="c1">// PWM (RGB)</span>
<span class="k">extern</span> <span class="n">TIM_HandleTypeDef</span> <span class="n">htim4</span><span class="p">;</span> <span class="c1">// 1s 周期中断</span>

<span class="cm">/* 初始化 */</span>
<span class="kt">void</span> <span class="nf">TIM3_PWM_Init</span><span class="p">(</span><span class="kt">uint16_t</span> <span class="n">arr</span><span class="p">,</span> <span class="kt">uint16_t</span> <span class="n">psc</span><span class="p">);</span>
<span class="kt">void</span> <span class="nf">TIM4_1s_Init</span><span class="p">(</span><span class="kt">uint16_t</span> <span class="n">arr</span><span class="p">,</span> <span class="kt">uint16_t</span> <span class="n">psc</span><span class="p">);</span>

<span class="cm">/* 设置 RGB 占空比：0~arr（arr=自动重装值） */</span>
<span class="kt">void</span> <span class="nf">LED_SetRGB</span><span class="p">(</span><span class="kt">uint16_t</span> <span class="n">r</span><span class="p">,</span> <span class="kt">uint16_t</span> <span class="n">g</span><span class="p">,</span> <span class="kt">uint16_t</span> <span class="n">b</span><span class="p">);</span>

<span class="cm">/* 作业5：七彩灯（1s 切换） */</span>
<span class="kt">void</span> <span class="nf">Rainbow_Init</span><span class="p">(</span><span class="kt">void</span><span class="p">);</span>

<span class="cm">/* 作业6：四彩呼吸灯（周期 1.5s） */</span>
<span class="kt">void</span> <span class="nf">Breath_Init</span><span class="p">(</span><span class="kt">void</span><span class="p">);</span>

<span class="kt">void</span> <span class="nf">LED_ChannelTest</span><span class="p">(</span><span class="kt">void</span><span class="p">);</span>

<span class="cp">#endif
</span></pre></td></tr></tbody></table></code></div></div>
<p>接下来实现切换颜色。这里应作业要求，使用另一个计时器，本文采用TIM4.切换颜色并不需要高频变换，最自然的办法是使用计时器做一个1Hz的软节拍，每1s产生一次更新中断。NVIC 开启 TIM4_IRQn，在TIM4_IRQHandler 里调用HAL_TIM_IRQHandler，最终会进入HAL_TIM_PeriodElapsedCallback。</p>
<div class="language-c highlighter-rouge"><div class="code-header">
        <span data-label-text="C"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
78
79
80
81
82
83
84
85
86
87
88
89
90
91
92
93
94
95
96
97
98
99
100
101
102
103
104
105
106
107
108
109
110
111
112
</pre></td><td class="rouge-code"><pre><span class="n">IM_HandleTypeDef</span> <span class="n">htim3</span><span class="p">;</span>
<span class="n">TIM_HandleTypeDef</span> <span class="n">htim4</span><span class="p">;</span>

<span class="cp">#ifndef M_PI
#define M_PI 3.14159265358979323846
#endif
</span>
<span class="k">typedef</span> <span class="k">enum</span> <span class="p">{</span> <span class="n">MODE_NONE</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="n">MODE_RAINBOW</span><span class="p">,</span> <span class="n">MODE_BREATH</span> <span class="p">}</span> <span class="n">TimerMode_t</span><span class="p">;</span>
<span class="k">static</span> <span class="n">TimerMode_t</span> <span class="n">g_mode</span> <span class="o">=</span> <span class="n">MODE_NONE</span><span class="p">;</span>
<span class="o">/</span>
<span class="kt">void</span> <span class="nf">TIM3_PWM_Init</span><span class="p">(</span><span class="kt">uint16_t</span> <span class="n">arr</span><span class="p">,</span> <span class="kt">uint16_t</span> <span class="n">psc</span><span class="p">)</span>
<span class="p">{</span>
    <span class="n">__HAL_RCC_TIM3_CLK_ENABLE</span><span class="p">();</span>
    <span class="n">__HAL_RCC_GPIOB_CLK_ENABLE</span><span class="p">();</span>
    <span class="n">__HAL_RCC_AFIO_CLK_ENABLE</span><span class="p">();</span>

    <span class="cm">/* TIM3 部分重映射: CH2-&gt;PB5, CH3-&gt;PB0, CH4-&gt;PB1 */</span>
    <span class="n">__HAL_AFIO_REMAP_TIM3_PARTIAL</span><span class="p">();</span>

    <span class="n">GPIO_InitTypeDef</span> <span class="n">GPIO_InitStruct</span> <span class="o">=</span> <span class="p">{</span><span class="mi">0</span><span class="p">};</span>
    <span class="n">GPIO_InitStruct</span><span class="p">.</span><span class="n">Mode</span>  <span class="o">=</span> <span class="n">GPIO_MODE_AF_PP</span><span class="p">;</span>
    <span class="n">GPIO_InitStruct</span><span class="p">.</span><span class="n">Pull</span>  <span class="o">=</span> <span class="n">GPIO_NOPULL</span><span class="p">;</span>
    <span class="n">GPIO_InitStruct</span><span class="p">.</span><span class="n">Speed</span> <span class="o">=</span> <span class="n">GPIO_SPEED_FREQ_HIGH</span><span class="p">;</span>

    <span class="cm">/* R/G/B 对应引脚 */</span>
    <span class="n">GPIO_InitStruct</span><span class="p">.</span><span class="n">Pin</span> <span class="o">=</span> <span class="n">GPIO_PIN_5</span><span class="p">;</span> <span class="n">HAL_GPIO_Init</span><span class="p">(</span><span class="n">GPIOB</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">GPIO_InitStruct</span><span class="p">);</span> <span class="c1">// CH2 → PB5 → R</span>
    <span class="n">GPIO_InitStruct</span><span class="p">.</span><span class="n">Pin</span> <span class="o">=</span> <span class="n">GPIO_PIN_0</span><span class="p">;</span> <span class="n">HAL_GPIO_Init</span><span class="p">(</span><span class="n">GPIOB</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">GPIO_InitStruct</span><span class="p">);</span> <span class="c1">// CH3 → PB0 → G</span>
    <span class="n">GPIO_InitStruct</span><span class="p">.</span><span class="n">Pin</span> <span class="o">=</span> <span class="n">GPIO_PIN_1</span><span class="p">;</span> <span class="n">HAL_GPIO_Init</span><span class="p">(</span><span class="n">GPIOB</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">GPIO_InitStruct</span><span class="p">);</span> <span class="c1">// CH4 → PB1 → B</span>

    <span class="cm">/* TIM3 基本参数 */</span>
    <span class="n">htim3</span><span class="p">.</span><span class="n">Instance</span> <span class="o">=</span> <span class="n">TIM3</span><span class="p">;</span>
    <span class="n">htim3</span><span class="p">.</span><span class="n">Init</span><span class="p">.</span><span class="n">Prescaler</span>         <span class="o">=</span> <span class="n">psc</span><span class="p">;</span>
    <span class="n">htim3</span><span class="p">.</span><span class="n">Init</span><span class="p">.</span><span class="n">CounterMode</span>       <span class="o">=</span> <span class="n">TIM_COUNTERMODE_UP</span><span class="p">;</span>
    <span class="n">htim3</span><span class="p">.</span><span class="n">Init</span><span class="p">.</span><span class="n">Period</span>            <span class="o">=</span> <span class="n">arr</span><span class="p">;</span>
    <span class="n">htim3</span><span class="p">.</span><span class="n">Init</span><span class="p">.</span><span class="n">ClockDivision</span>     <span class="o">=</span> <span class="n">TIM_CLOCKDIVISION_DIV1</span><span class="p">;</span>
    <span class="n">htim3</span><span class="p">.</span><span class="n">Init</span><span class="p">.</span><span class="n">AutoReloadPreload</span> <span class="o">=</span> <span class="n">TIM_AUTORELOAD_PRELOAD_DISABLE</span><span class="p">;</span>
    <span class="n">HAL_TIM_PWM_Init</span><span class="p">(</span><span class="o">&amp;</span><span class="n">htim3</span><span class="p">);</span>

    <span class="cm">/* 三路 PWM 通道配置：有效低（低电平点亮，数值越大越亮） */</span>
    <span class="n">TIM_OC_InitTypeDef</span> <span class="n">sOC</span> <span class="o">=</span> <span class="p">{</span><span class="mi">0</span><span class="p">};</span>
    <span class="n">sOC</span><span class="p">.</span><span class="n">OCMode</span>     <span class="o">=</span> <span class="n">TIM_OCMODE_PWM1</span><span class="p">;</span>
    <span class="n">sOC</span><span class="p">.</span><span class="n">Pulse</span>      <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
    <span class="n">sOC</span><span class="p">.</span><span class="n">OCPolarity</span> <span class="o">=</span> <span class="n">TIM_OCPOLARITY_LOW</span><span class="p">;</span>      <span class="c1">// ★ 有效低</span>
    <span class="n">sOC</span><span class="p">.</span><span class="n">OCFastMode</span> <span class="o">=</span> <span class="n">TIM_OCFAST_DISABLE</span><span class="p">;</span>

    <span class="n">HAL_TIM_PWM_ConfigChannel</span><span class="p">(</span><span class="o">&amp;</span><span class="n">htim3</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">sOC</span><span class="p">,</span> <span class="n">TIM_CHANNEL_2</span><span class="p">);</span> <span class="c1">// R</span>
    <span class="n">HAL_TIM_PWM_ConfigChannel</span><span class="p">(</span><span class="o">&amp;</span><span class="n">htim3</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">sOC</span><span class="p">,</span> <span class="n">TIM_CHANNEL_3</span><span class="p">);</span> <span class="c1">// G</span>
    <span class="n">HAL_TIM_PWM_ConfigChannel</span><span class="p">(</span><span class="o">&amp;</span><span class="n">htim3</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">sOC</span><span class="p">,</span> <span class="n">TIM_CHANNEL_4</span><span class="p">);</span> <span class="c1">// B</span>

    <span class="n">HAL_TIM_PWM_Start</span><span class="p">(</span><span class="o">&amp;</span><span class="n">htim3</span><span class="p">,</span> <span class="n">TIM_CHANNEL_2</span><span class="p">);</span>
    <span class="n">HAL_TIM_PWM_Start</span><span class="p">(</span><span class="o">&amp;</span><span class="n">htim3</span><span class="p">,</span> <span class="n">TIM_CHANNEL_3</span><span class="p">);</span>
    <span class="n">HAL_TIM_PWM_Start</span><span class="p">(</span><span class="o">&amp;</span><span class="n">htim3</span><span class="p">,</span> <span class="n">TIM_CHANNEL_4</span><span class="p">);</span>
<span class="p">}</span>

<span class="kt">void</span> <span class="nf">TIM4_Base_Init</span><span class="p">(</span><span class="kt">uint16_t</span> <span class="n">arr</span><span class="p">,</span> <span class="kt">uint16_t</span> <span class="n">psc</span><span class="p">)</span>
<span class="p">{</span>
    <span class="n">__HAL_RCC_TIM4_CLK_ENABLE</span><span class="p">();</span>

    <span class="n">htim4</span><span class="p">.</span><span class="n">Instance</span> <span class="o">=</span> <span class="n">TIM4</span><span class="p">;</span>
    <span class="n">htim4</span><span class="p">.</span><span class="n">Init</span><span class="p">.</span><span class="n">Prescaler</span>         <span class="o">=</span> <span class="n">psc</span><span class="p">;</span>
    <span class="n">htim4</span><span class="p">.</span><span class="n">Init</span><span class="p">.</span><span class="n">CounterMode</span>       <span class="o">=</span> <span class="n">TIM_COUNTERMODE_UP</span><span class="p">;</span>
    <span class="n">htim4</span><span class="p">.</span><span class="n">Init</span><span class="p">.</span><span class="n">Period</span>            <span class="o">=</span> <span class="n">arr</span><span class="p">;</span>
    <span class="n">htim4</span><span class="p">.</span><span class="n">Init</span><span class="p">.</span><span class="n">ClockDivision</span>     <span class="o">=</span> <span class="n">TIM_CLOCKDIVISION_DIV1</span><span class="p">;</span>
    <span class="n">htim4</span><span class="p">.</span><span class="n">Init</span><span class="p">.</span><span class="n">AutoReloadPreload</span> <span class="o">=</span> <span class="n">TIM_AUTORELOAD_PRELOAD_DISABLE</span><span class="p">;</span>
    <span class="n">HAL_TIM_Base_Init</span><span class="p">(</span><span class="o">&amp;</span><span class="n">htim4</span><span class="p">);</span>

    <span class="n">HAL_TIM_Base_Start_IT</span><span class="p">(</span><span class="o">&amp;</span><span class="n">htim4</span><span class="p">);</span>
    <span class="n">HAL_NVIC_SetPriority</span><span class="p">(</span><span class="n">TIM4_IRQn</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">);</span>
    <span class="n">HAL_NVIC_EnableIRQ</span><span class="p">(</span><span class="n">TIM4_IRQn</span><span class="p">);</span>
<span class="p">}</span>

<span class="kt">void</span> <span class="nf">LED_SetRGB</span><span class="p">(</span><span class="kt">uint16_t</span> <span class="n">r</span><span class="p">,</span> <span class="kt">uint16_t</span> <span class="n">g</span><span class="p">,</span> <span class="kt">uint16_t</span> <span class="n">b</span><span class="p">)</span>
<span class="p">{</span>
    <span class="k">const</span> <span class="kt">uint16_t</span> <span class="n">ARR</span> <span class="o">=</span> <span class="n">__HAL_TIM_GET_AUTORELOAD</span><span class="p">(</span><span class="o">&amp;</span><span class="n">htim3</span><span class="p">);</span>

    <span class="k">if</span> <span class="p">(</span><span class="n">r</span> <span class="o">&gt;</span> <span class="n">ARR</span><span class="p">)</span> <span class="n">r</span> <span class="o">=</span> <span class="n">ARR</span><span class="p">;</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">g</span> <span class="o">&gt;</span> <span class="n">ARR</span><span class="p">)</span> <span class="n">g</span> <span class="o">=</span> <span class="n">ARR</span><span class="p">;</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">b</span> <span class="o">&gt;</span> <span class="n">ARR</span><span class="p">)</span> <span class="n">b</span> <span class="o">=</span> <span class="n">ARR</span><span class="p">;</span>

    <span class="n">__HAL_TIM_SET_COMPARE</span><span class="p">(</span><span class="o">&amp;</span><span class="n">htim3</span><span class="p">,</span> <span class="n">TIM_CHANNEL_2</span><span class="p">,</span> <span class="n">r</span><span class="p">);</span> <span class="c1">// R -&gt; PB5</span>
    <span class="n">__HAL_TIM_SET_COMPARE</span><span class="p">(</span><span class="o">&amp;</span><span class="n">htim3</span><span class="p">,</span> <span class="n">TIM_CHANNEL_3</span><span class="p">,</span> <span class="n">g</span><span class="p">);</span> <span class="c1">// G -&gt; PB0</span>
    <span class="n">__HAL_TIM_SET_COMPARE</span><span class="p">(</span><span class="o">&amp;</span><span class="n">htim3</span><span class="p">,</span> <span class="n">TIM_CHANNEL_4</span><span class="p">,</span> <span class="n">b</span><span class="p">);</span> <span class="c1">// B -&gt; PB1</span>
<span class="p">}</span>

<span class="cm">/* ==========================================================================
 * 作业5：七彩灯（1s 切换，红→橙→黄→绿→青→蓝→紫）
 * ========================================================================== */</span>
<span class="k">static</span> <span class="kt">uint8_t</span> <span class="n">rainbow_state</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>

<span class="kt">void</span> <span class="nf">Rainbow_Init</span><span class="p">(</span><span class="kt">void</span><span class="p">)</span>
<span class="p">{</span>
    <span class="n">TIM4_Base_Init</span><span class="p">(</span><span class="mi">999</span><span class="p">,</span> <span class="mi">7999</span><span class="p">);</span>  <span class="c1">// 1s 节拍</span>
    <span class="n">rainbow_state</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
    <span class="n">g_mode</span> <span class="o">=</span> <span class="n">MODE_RAINBOW</span><span class="p">;</span>
<span class="p">}</span>

<span class="k">static</span> <span class="kt">void</span> <span class="nf">Rainbow_Update</span><span class="p">(</span><span class="kt">void</span><span class="p">)</span>
<span class="p">{</span>
    <span class="k">const</span> <span class="kt">uint16_t</span> <span class="n">ARR</span> <span class="o">=</span> <span class="n">__HAL_TIM_GET_AUTORELOAD</span><span class="p">(</span><span class="o">&amp;</span><span class="n">htim3</span><span class="p">);</span>

    <span class="k">switch</span> <span class="p">(</span><span class="n">rainbow_state</span><span class="p">)</span>
    <span class="p">{</span>
        <span class="k">case</span> <span class="mi">0</span><span class="p">:</span> <span class="n">LED_SetRGB</span><span class="p">(</span><span class="n">ARR</span><span class="p">,</span>   <span class="mi">0</span><span class="p">,</span>   <span class="mi">0</span><span class="p">);</span> <span class="k">break</span><span class="p">;</span>        <span class="c1">// 红</span>
        <span class="k">case</span> <span class="mi">1</span><span class="p">:</span> <span class="n">LED_SetRGB</span><span class="p">(</span><span class="n">ARR</span><span class="p">,</span> <span class="n">ARR</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">);</span> <span class="k">break</span><span class="p">;</span>        <span class="c1">// 橙 = 红 + 半绿</span>
        <span class="k">case</span> <span class="mi">2</span><span class="p">:</span> <span class="n">LED_SetRGB</span><span class="p">(</span><span class="n">ARR</span><span class="p">,</span> <span class="n">ARR</span><span class="p">,</span>   <span class="mi">0</span><span class="p">);</span> <span class="k">break</span><span class="p">;</span>        <span class="c1">// 黄 = 红 + 绿</span>
        <span class="k">case</span> <span class="mi">3</span><span class="p">:</span> <span class="n">LED_SetRGB</span><span class="p">(</span>  <span class="mi">0</span><span class="p">,</span> <span class="n">ARR</span><span class="p">,</span>   <span class="mi">0</span><span class="p">);</span> <span class="k">break</span><span class="p">;</span>        <span class="c1">// 绿</span>
        <span class="k">case</span> <span class="mi">4</span><span class="p">:</span> <span class="n">LED_SetRGB</span><span class="p">(</span>  <span class="mi">0</span><span class="p">,</span> <span class="n">ARR</span><span class="p">,</span> <span class="n">ARR</span><span class="p">);</span> <span class="k">break</span><span class="p">;</span>        <span class="c1">// 青 = 绿 + 蓝</span>
        <span class="k">case</span> <span class="mi">5</span><span class="p">:</span> <span class="n">LED_SetRGB</span><span class="p">(</span>  <span class="mi">0</span><span class="p">,</span>   <span class="mi">0</span><span class="p">,</span> <span class="n">ARR</span><span class="p">);</span> <span class="k">break</span><span class="p">;</span>        <span class="c1">// 蓝</span>
        <span class="k">case</span> <span class="mi">6</span><span class="p">:</span> <span class="n">LED_SetRGB</span><span class="p">(</span><span class="n">ARR</span><span class="p">,</span>   <span class="mi">0</span><span class="p">,</span> <span class="n">ARR</span><span class="p">);</span> <span class="k">break</span><span class="p">;</span>        <span class="c1">// 紫 = 红 + 蓝</span>
    <span class="p">}</span>
    <span class="n">rainbow_state</span> <span class="o">=</span> <span class="p">(</span><span class="n">rainbow_state</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">%</span> <span class="mi">7</span><span class="p">;</span>
<span class="p">}</span>
</pre></td></tr></tbody></table></code></div></div>
<p>之后进行编译和烧录即可。</p>

<h3 id="作业-呼吸灯"><span class="me-2">作业-呼吸灯</span><a href="#作业-呼吸灯" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3>
<p>作业内容：使用相应软件操作STM32开发板，产生4彩（红、绿、蓝、白）呼吸灯，呼吸周期为1.x秒（x为学号尾数），CCR更新周期不高于0.2s。</p>

<p>呼吸灯的核心是占空比的周期性变化。首先回顾PWM的内容。PWM 是 Pulse Width Modulation（脉冲宽度调制）的缩写，是一种通过改变脉冲信号的高电平持续时间与周期的比例，来模拟信号效果的数字控制技术。STM32 的定时器，如TIM3，可硬件生成高精度 PWM 信号，无需 CPU 持续干预。对 LED 来说，在频率足够高的情况下，人眼会因为视觉暂留把高频闪烁看作持续的光。TIMx作为PWM的时基有频率公式：
\(f_{PWM} = \frac{f_{TIMCLK}}{(PSC+1) \times (ARR+1)}\)</p>

<p>其中ARR为自动重装载寄存器，决定周期长度，即计数上限；PSC为预分频器，决定计数节拍变慢多少；CRR是捕获/比较寄存器，对应占空比。因而只需让CCR随着时间先增再减就能实现呼吸效果。本文采用余弦函数产生更平滑的呼吸效果：
\(duty(t) = \frac{1-\cos{(\frac{2\pi t}{T}})}{2}\)</p>

<p>其中duty∈[0,1]，T为呼吸周期。
之后设置两个计时器，按照作业5的形式定义TIM3和TIM4的行为，这里不再赘述。
最终在上一节代码之后追加：</p>
<div class="language-c highlighter-rouge"><div class="code-header">
        <span data-label-text="C"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
</pre></td><td class="rouge-code"><pre><span class="cp">#define BREATH_PERIOD 1.5f
#define BREATH_DT     0.1f
</span>
<span class="k">static</span> <span class="kt">uint16_t</span> <span class="n">breath_step</span>  <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
<span class="k">static</span> <span class="kt">uint8_t</span>  <span class="n">breath_color</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>

<span class="kt">void</span> <span class="nf">Breath_Init</span><span class="p">(</span><span class="kt">void</span><span class="p">)</span>
<span class="p">{</span>
    <span class="n">TIM4_Base_Init</span><span class="p">(</span><span class="mi">99</span><span class="p">,</span> <span class="mi">7999</span><span class="p">);</span>  <span class="c1">// 0.1s 节拍</span>
    <span class="n">breath_step</span>  <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
    <span class="n">breath_color</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
    <span class="n">g_mode</span> <span class="o">=</span> <span class="n">MODE_BREATH</span><span class="p">;</span>
<span class="p">}</span>

<span class="k">static</span> <span class="kt">void</span> <span class="nf">Breath_Update</span><span class="p">(</span><span class="kt">void</span><span class="p">)</span>
<span class="p">{</span>
    <span class="k">const</span> <span class="kt">uint16_t</span> <span class="n">ARR</span> <span class="o">=</span> <span class="n">__HAL_TIM_GET_AUTORELOAD</span><span class="p">(</span><span class="o">&amp;</span><span class="n">htim3</span><span class="p">);</span>
    <span class="k">const</span> <span class="kt">uint16_t</span> <span class="n">steps_per_cycle</span> <span class="o">=</span> <span class="p">(</span><span class="kt">uint16_t</span><span class="p">)(</span><span class="n">BREATH_PERIOD</span> <span class="o">/</span> <span class="n">BREATH_DT</span><span class="p">);</span> <span class="c1">// 例如1.5/0.1=15</span>

    <span class="kt">float</span> <span class="n">x</span>    <span class="o">=</span> <span class="p">(</span><span class="kt">float</span><span class="p">)</span><span class="n">breath_step</span> <span class="o">/</span> <span class="p">(</span><span class="kt">float</span><span class="p">)</span><span class="n">steps_per_cycle</span><span class="p">;</span>       <span class="c1">// 0..1</span>
    <span class="kt">float</span> <span class="n">duty</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span><span class="p">.</span><span class="mi">0</span><span class="n">f</span> <span class="o">-</span> <span class="n">cosf</span><span class="p">(</span><span class="mi">2</span><span class="p">.</span><span class="mi">0</span><span class="n">f</span> <span class="o">*</span> <span class="p">(</span><span class="kt">float</span><span class="p">)</span><span class="n">M_PI</span> <span class="o">*</span> <span class="n">x</span><span class="p">))</span> <span class="o">*</span> <span class="mi">0</span><span class="p">.</span><span class="mi">5</span><span class="n">f</span><span class="p">;</span>      <span class="c1">// 余弦曲线 0..1</span>
    <span class="kt">uint16_t</span> <span class="n">v</span> <span class="o">=</span> <span class="p">(</span><span class="kt">uint16_t</span><span class="p">)(</span><span class="n">duty</span> <span class="o">*</span> <span class="n">ARR</span><span class="p">);</span>

    <span class="k">switch</span> <span class="p">(</span><span class="n">breath_color</span><span class="p">)</span>
    <span class="p">{</span>
        <span class="k">case</span> <span class="mi">0</span><span class="p">:</span> <span class="n">LED_SetRGB</span><span class="p">(</span><span class="n">v</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">);</span>           <span class="k">break</span><span class="p">;</span>  <span class="c1">// 红</span>
        <span class="k">case</span> <span class="mi">1</span><span class="p">:</span> <span class="n">LED_SetRGB</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">v</span><span class="p">,</span> <span class="mi">0</span><span class="p">);</span>           <span class="k">break</span><span class="p">;</span>  <span class="c1">// 绿</span>
        <span class="k">case</span> <span class="mi">2</span><span class="p">:</span> <span class="n">LED_SetRGB</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">v</span><span class="p">);</span>           <span class="k">break</span><span class="p">;</span>  <span class="c1">// 蓝</span>
        <span class="k">case</span> <span class="mi">3</span><span class="p">:</span> <span class="n">LED_SetRGB</span><span class="p">(</span><span class="n">v</span><span class="p">,</span> <span class="n">v</span><span class="p">,</span> <span class="n">v</span><span class="p">);</span>           <span class="k">break</span><span class="p">;</span>  <span class="c1">// 白</span>
        <span class="nl">default:</span> <span class="k">break</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="n">breath_step</span><span class="o">++</span><span class="p">;</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">breath_step</span> <span class="o">&gt;=</span> <span class="n">steps_per_cycle</span><span class="p">)</span>
    <span class="p">{</span>
        <span class="n">breath_step</span>  <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
        <span class="n">breath_color</span> <span class="o">=</span> <span class="p">(</span><span class="n">breath_color</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">%</span> <span class="mi">4</span><span class="p">;</span> <span class="c1">// 红→绿→蓝→白</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></td></tr></tbody></table></code></div></div>


  </div>

  <div class="post-tail-wrapper text-muted">
    <!-- categories -->
    
      <div class="post-meta mb-3">
        <i class="far fa-folder-open fa-fw me-1"></i>
        
          <a href="/categories/coding/">Coding</a>
      </div>
    

    <!-- tags -->
    
      <div class="post-tags">
        <i class="fa fa-tags fa-fw me-1"></i>
        
          <a
            href="/tags/c-c/"
            class="post-tag no-text-decoration"
          >c/c++</a>
        
          <a
            href="/tags/stm32/"
            class="post-tag no-text-decoration"
          >stm32</a>
        
          <a
            href="/tags/clion/"
            class="post-tag no-text-decoration"
          >clion</a>
        
      </div>
    

    <div
      class="
        post-tail-bottom
        d-flex justify-content-between align-items-center mt-5 pb-2
      "
    >
      <div class="license-wrapper">
        
          

          This post is licensed under 
        <a href="https://creativecommons.org/licenses/by/4.0/">
          CC BY 4.0
        </a>
         by the author.
        
      </div>

      <!-- Post sharing snippet -->

<div class="share-wrapper d-flex align-items-center">
  <span class="share-label text-muted">Share</span>
  <span class="share-icons">
    
    
    

    

      

      <a href="https://twitter.com/intent/tweet?text=BIT%20ECE%E5%AE%9E%E4%B9%A0%E4%B9%8BSTM32%E5%BC%80%E5%8F%91%20-%20lamaper&url=%2Fposts%2Fbit-ece-stm32%2F" target="_blank" rel="noopener" data-bs-toggle="tooltip" data-bs-placement="top" title="Twitter" aria-label="Twitter">
        <i class="fa-fw fa-brands fa-square-x-twitter"></i>
      </a>
    

      

      <a href="https://www.facebook.com/sharer/sharer.php?title=BIT%20ECE%E5%AE%9E%E4%B9%A0%E4%B9%8BSTM32%E5%BC%80%E5%8F%91%20-%20lamaper&u=%2Fposts%2Fbit-ece-stm32%2F" target="_blank" rel="noopener" data-bs-toggle="tooltip" data-bs-placement="top" title="Facebook" aria-label="Facebook">
        <i class="fa-fw fab fa-facebook-square"></i>
      </a>
    

      

      <a href="https://t.me/share/url?url=%2Fposts%2Fbit-ece-stm32%2F&text=BIT%20ECE%E5%AE%9E%E4%B9%A0%E4%B9%8BSTM32%E5%BC%80%E5%8F%91%20-%20lamaper" target="_blank" rel="noopener" data-bs-toggle="tooltip" data-bs-placement="top" title="Telegram" aria-label="Telegram">
        <i class="fa-fw fab fa-telegram"></i>
      </a>
    

    <button
      id="copy-link"
      aria-label="Copy link"
      class="btn small"
      data-bs-toggle="tooltip"
      data-bs-placement="top"
      title="Copy link"
      data-title-succeed="Link copied successfully!"
    >
      <i class="fa-fw fas fa-link pe-none fs-6"></i>
    </button>
  </span>
</div>

    </div>
    <!-- .post-tail-bottom -->
  </div>
  <!-- div.post-tail-wrapper -->
</article>


            
          </main>

          <!-- panel -->
          <aside aria-label="Panel" id="panel-wrapper" class="col-xl-3 ps-2 text-muted">
            <div class="access">
              <!-- Get 5 last posted/updated posts -->














  <section id="access-lastmod">
    <h2 class="panel-heading">Recently Updated</h2>
    <ul class="content list-unstyled ps-0 pb-1 ms-1 mt-2">
      
        
        
        
        <li class="text-truncate lh-lg">
          <a href="/posts/py-ssti/">Python SSTI研究</a>
        </li>
      
        
        
        
        <li class="text-truncate lh-lg">
          <a href="/posts/nodejs-vm-esc/">Node JS沙箱逃逸</a>
        </li>
      
        
        
        
        <li class="text-truncate lh-lg">
          <a href="/posts/bit-ece-stm32/">BIT ECE实习之STM32开发</a>
        </li>
      
        
        
        
        <li class="text-truncate lh-lg">
          <a href="/posts/qt-qxlsx/">Qt6.7.3（MSVC2022）安装外部库QXlsx</a>
        </li>
      
        
        
        
        <li class="text-truncate lh-lg">
          <a href="/posts/CS61B/">UCB CS61B学习笔记</a>
        </li>
      
    </ul>
  </section>
  <!-- #access-lastmod -->


              <!-- The trending tags list -->















  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
      
        
        



  <section>
    <h2 class="panel-heading">Trending Tags</h2>
    <div class="d-flex flex-wrap mt-3 mb-1 me-3">
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/web/">web</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/ctf/">ctf</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/php/">php</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/algorithm/">algorithm</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/python/">python</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/arcgis/">arcgis</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/blogs/">blogs</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/c-c/">c/c++</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/coding/">coding</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/computer-science/">computer science</a>
      
    </div>
  </section>


            </div>

            
              
              






  <div class="toc-border-cover z-3"></div>
  <section id="toc-wrapper" class="invisible position-sticky ps-0 pe-4 pb-4">
    <h2 class="panel-heading ps-3 pb-2 mb-0">Contents</h2>
    <nav id="toc"></nav>
  </section>


            
          </aside>
        </div>

        <div class="row">
          <!-- tail -->
          <div id="tail-wrapper" class="col-12 col-lg-11 col-xl-9 px-md-4">
            
              
              <!-- Recommend the other 3 posts according to the tags and categories of the current post. -->

<!-- The total size of related posts -->


<!-- An random integer that bigger than 0 -->


<!-- Equals to TAG_SCORE / {max_categories_hierarchy} -->















  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  
    










  <aside id="related-posts" aria-labelledby="related-label">
    <h3 class="mb-4" id="related-label">Further Reading</h3>
    <nav class="row row-cols-1 row-cols-md-2 row-cols-xl-3 g-4 mb-4">
      
        <article class="col">
          <a href="/posts/c-in-bit/" class="post-preview card h-100">
            <div class="card-body">
              <!--
  Date format snippet
  See: ${JS_ROOT}/utils/locale-dateime.js
-->




<time
  
  data-ts="1740670242"
  data-df="ll"
  
>
  Feb 27, 2025
</time>

              <h4 class="pt-0 my-2">一些神奇的C语言题目</h4>
              <div class="text-muted">
                <p>出现在BIT C语言程序设计（赵三元老师）课程中的奇妙题目</p>
              </div>
            </div>
          </a>
        </article>
      
        <article class="col">
          <a href="/posts/qt-qxlsx/" class="post-preview card h-100">
            <div class="card-body">
              <!--
  Date format snippet
  See: ${JS_ROOT}/utils/locale-dateime.js
-->




<time
  
  data-ts="1756564020"
  data-df="ll"
  
>
  Aug 30, 2025
</time>

              <h4 class="pt-0 my-2">Qt6.7.3（MSVC2022）安装外部库QXlsx</h4>
              <div class="text-muted">
                <p>Qt安装外部库</p>
              </div>
            </div>
          </a>
        </article>
      
        <article class="col">
          <a href="/posts/CS61B/" class="post-preview card h-100">
            <div class="card-body">
              <!--
  Date format snippet
  See: ${JS_ROOT}/utils/locale-dateime.js
-->




<time
  
  data-ts="1752156840"
  data-df="ll"
  
>
  Jul 10, 2025
</time>

              <h4 class="pt-0 my-2">UCB CS61B学习笔记</h4>
              <div class="text-muted">
                <p>学习数据结构与算法</p>
              </div>
            </div>
          </a>
        </article>
      
    </nav>
  </aside>
  <!-- #related-posts -->


            
              
              <!-- Navigation buttons at the bottom of the post. -->

<nav class="post-navigation d-flex justify-content-between" aria-label="Post Navigation">
  
  

  
    <a
      href="/posts/qt-qxlsx/"
      class="btn btn-outline-primary"
      aria-label="Older"
    >
      <p>Qt6.7.3（MSVC2022）安装外部库QXlsx</p>
    </a>
  

  
    <a
      href="/posts/nodejs-vm-esc/"
      class="btn btn-outline-primary"
      aria-label="Newer"
    >
      <p>Node JS沙箱逃逸</p>
    </a>
  
</nav>

            

            <!-- The Footer -->

<footer
  aria-label="Site Info"
  class="
    d-flex flex-column justify-content-center text-muted
    flex-lg-row justify-content-lg-between align-items-lg-center pb-lg-3
  "
>
  <p>©
    <time>2025</time>

    
      <a href="https://github.com/lamaper">lamaper</a>.
    

    
      <span
        data-bs-toggle="tooltip"
        data-bs-placement="top"
        title="Except where otherwise noted, the blog posts on this site are licensed under the Creative Commons Attribution 4.0 International (CC BY 4.0) License by the author."
      >Some rights reserved.</span>
    
  </p>

  <p>Using the <a
        data-bs-toggle="tooltip"
        data-bs-placement="top"
        title="v7.4.1"
        href="https://github.com/cotes2020/jekyll-theme-chirpy"
        target="_blank"
        rel="noopener"
      >Chirpy</a> theme for <a href="https://jekyllrb.com" target="_blank" rel="noopener">Jekyll</a>.
  </p>
</footer>

          </div>
        </div>

        <!-- The Search results -->

<div id="search-result-wrapper" class="d-flex justify-content-center d-none">
  <div class="col-11 content">
    <div id="search-hints">
      <!-- The trending tags list -->















  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
      
        
        



  <section>
    <h2 class="panel-heading">Trending Tags</h2>
    <div class="d-flex flex-wrap mt-3 mb-1 me-3">
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/web/">web</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/ctf/">ctf</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/php/">php</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/algorithm/">algorithm</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/python/">python</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/arcgis/">arcgis</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/blogs/">blogs</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/c-c/">c/c++</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/coding/">coding</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/computer-science/">computer science</a>
      
    </div>
  </section>


    </div>
    <div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div>
  </div>
</div>

      </div>

      <aside aria-label="Scroll to Top">
        <button id="back-to-top" type="button" class="btn btn-lg btn-box-shadow">
          <i class="fas fa-angle-up"></i>
        </button>
      </aside>
    </div>

    <div id="mask" class="d-none position-fixed w-100 h-100 z-1"></div>

    
      <aside
  id="notification"
  class="toast"
  role="alert"
  aria-live="assertive"
  aria-atomic="true"
  data-bs-animation="true"
  data-bs-autohide="false"
>
  <div class="toast-header">
    <button
      type="button"
      class="btn-close ms-auto"
      data-bs-dismiss="toast"
      aria-label="Close"
    ></button>
  </div>
  <div class="toast-body text-center pt-0">
    <p class="px-2 mb-3">A new version of content is available.</p>
    <button type="button" class="btn btn-primary" aria-label="Update">
      Update
    </button>
  </div>
</aside>

    

    <!-- Embedded scripts -->

    
      
      <!-- The comments switcher -->


    

    <!--
  Jekyll Simple Search loader
  See: <https://github.com/christian-fei/Simple-Jekyll-Search>
-->





<script>
  
  document.addEventListener('DOMContentLoaded', () => {
    SimpleJekyllSearch({
      searchInput: document.getElementById('search-input'),
      resultsContainer: document.getElementById('search-results'),
      json: '/assets/js/data/search.json',
      searchResultTemplate: '  <article class="px-1 px-sm-2 px-lg-4 px-xl-0">    <header>      <h2><a href="{url}">{title}</a></h2>      <div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1">        {categories}        {tags}      </div>    </header>    <p>{content}</p>  </article>',
      noResultsText: '<p class="mt-5">Oops! No results found.</p>',
      templateMiddleware: function(prop, value, template) {
        if (prop === 'categories') {
          if (value === '') {
            return `${value}`;
          } else {
            return `<div class="me-sm-4"><i class="far fa-folder fa-fw"></i>${value}</div>`;
          }
        }

        if (prop === 'tags') {
          if (value === '') {
            return `${value}`;
          } else {
            return `<div><i class="fa fa-tag fa-fw"></i>${value}</div>`;
          }
        }
      }
    });
  });
</script>

  </body>
</html>

